{"version":3,"file":"chunks/app_views_settings_account_notifications_notificationSettings_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/alertLink.tsx","webpack:///./app/views/settings/account/notifications/constants.tsx","webpack:///./app/views/settings/account/notifications/fields2.tsx","webpack:///./app/views/settings/account/notifications/notificationSettings.tsx","webpack:///./app/views/settings/account/notifications/parentLabel.tsx","webpack:///./app/views/settings/account/notifications/utils.tsx"],"sourcesContent":["import * as React from 'react';\nimport styled from '@emotion/styled';\nimport omit from 'lodash/omit';\n\nimport ExternalLink from 'app/components/links/externalLink';\nimport Link from 'app/components/links/link';\nimport {IconChevron} from 'app/icons';\nimport space from 'app/styles/space';\n\ntype Size = 'small' | 'normal';\ntype Priority = 'info' | 'warning' | 'success' | 'error' | 'muted';\n\ntype LinkProps = React.ComponentPropsWithoutRef<typeof Link>;\n\ntype OtherProps = {\n  ['data-test-id']?: string;\n  icon?: string | React.ReactNode;\n  onClick?: (e: React.MouseEvent) => void;\n  children?: React.ReactNode;\n};\n\ntype DefaultProps = {\n  size: Size;\n  priority: Priority;\n  withoutMarginBottom: boolean;\n  openInNewTab: boolean;\n  href?: string;\n};\n\ntype Props = OtherProps & Partial<DefaultProps> & Partial<Pick<LinkProps, 'to'>>;\n\ntype StyledLinkProps = DefaultProps &\n  Partial<Pick<LinkProps, 'to'>> &\n  Omit<LinkProps, 'to' | 'size'>;\n\nfunction AlertLink({\n  size = 'normal',\n  priority = 'warning',\n  icon,\n  children,\n  onClick,\n  withoutMarginBottom = false,\n  openInNewTab = false,\n  to,\n  href,\n  ['data-test-id']: dataTestId,\n}: Props) {\n  return (\n    <StyledLink\n      data-test-id={dataTestId}\n      to={to}\n      href={href}\n      onClick={onClick}\n      size={size}\n      priority={priority}\n      withoutMarginBottom={withoutMarginBottom}\n      openInNewTab={openInNewTab}\n    >\n      {icon && <IconWrapper>{icon}</IconWrapper>}\n      <AlertLinkText>{children}</AlertLinkText>\n      <IconLink>\n        <IconChevron direction=\"right\" />\n      </IconLink>\n    </StyledLink>\n  );\n}\n\nexport default AlertLink;\n\nconst StyledLink = styled(({openInNewTab, to, href, ...props}: StyledLinkProps) => {\n  const linkProps = omit(props, ['withoutMarginBottom', 'priority', 'size']);\n  if (href) {\n    return <ExternalLink {...linkProps} href={href} openInNewTab={openInNewTab} />;\n  }\n\n  return <Link {...linkProps} to={to || ''} />;\n})`\n  display: flex;\n  background-color: ${p => p.theme.alert[p.priority].backgroundLight};\n  color: ${p => p.theme.textColor};\n  border: 1px dashed ${p => p.theme.alert[p.priority].border};\n  padding: ${p => (p.size === 'small' ? `${space(1)} ${space(1.5)}` : space(2))};\n  margin-bottom: ${p => (p.withoutMarginBottom ? 0 : space(3))};\n  border-radius: 0.25em;\n  transition: 0.2s border-color;\n\n  &.focus-visible {\n    outline: none;\n    box-shadow: ${p => p.theme.alert[p.priority].border}7f 0 0 0 2px;\n  }\n`;\n\nconst IconWrapper = styled('span')`\n  display: flex;\n  margin: ${space(0.5)} ${space(1.5)} ${space(0.5)} 0;\n`;\n\nconst IconLink = styled(IconWrapper)`\n  margin: ${space(0.5)} 0;\n`;\n\nconst AlertLinkText = styled('div')`\n  line-height: 1.5;\n  flex-grow: 1;\n`;\n","import {t} from 'app/locale';\n\nexport const ALL_PROVIDERS = {\n  email: 'default',\n  slack: 'never',\n};\n\n/**\n * These values are stolen from the DB.\n */\nexport const VALUE_MAPPING = {\n  default: 0,\n  never: 10,\n  always: 20,\n  subscribe_only: 30,\n  committed_only: 40,\n};\n\nexport const MIN_PROJECTS_FOR_CONFIRMATION = 3;\nexport const MIN_PROJECTS_FOR_SEARCH = 3;\nexport const MIN_PROJECTS_FOR_PAGINATION = 100;\n\nexport type NotificationSettingsByProviderObject = {[key: string]: string};\nexport type NotificationSettingsObject = {\n  [key: string]: {[key: string]: {[key: string]: NotificationSettingsByProviderObject}};\n};\n\nexport const NOTIFICATION_SETTINGS_TYPES = [\n  'alerts',\n  'workflow',\n  'deploy',\n  'reports',\n  'email',\n];\n\nexport const SELF_NOTIFICATION_SETTINGS_TYPES = [\n  'personalActivityNotifications',\n  'selfAssignOnResolve',\n];\n\nexport const CONFIRMATION_MESSAGE = (\n  <div>\n    <p style={{marginBottom: '20px'}}>\n      <strong>Are you sure you want to disable these notifications?</strong>\n    </p>\n    <p>\n      {t(\n        'Turning this off will irreversibly overwrite all of your fine-tuning settings to \"off\".'\n      )}\n    </p>\n  </div>\n);\n","import * as React from 'react';\n\nimport {t} from 'app/locale';\n\nexport type NotificationSettingField = {\n  name: string;\n  type: 'select' | 'blank' | 'boolean';\n  label: string;\n  choices?: string[][];\n  defaultValue?: string;\n  defaultFieldName?: string;\n  help?: string;\n  confirm?: {[key: string]: React.ReactNode | string};\n};\n\nexport const NOTIFICATION_SETTING_FIELDS: Record<string, NotificationSettingField> = {\n  alerts: {\n    name: 'alerts',\n    type: 'select',\n    label: t('Issue Alerts'),\n    choices: [\n      ['always', t('On')],\n      ['never', t('Off')],\n    ],\n    help: t('Notifications sent from Alert rules that your team has set up.'),\n  },\n  workflow: {\n    name: 'workflow',\n    type: 'select',\n    label: t('Issue Workflow'),\n    choices: [\n      ['always', t('On')],\n      ['subscribe_only', t('Only Subscribed Issues')],\n      ['never', t('Off')],\n    ],\n    help: t('Changes in issue assignment, resolution status, and comments.'),\n  },\n  deploy: {\n    name: 'deploy',\n    type: 'select',\n    label: t('Deploys'),\n    choices: [\n      ['always', t('On')],\n      ['committed_only', t('Only Committed Issues')],\n      ['never', t('Off')],\n    ],\n    help: t('Release, environment, and commit overviews.'),\n  },\n  provider: {\n    name: 'provider',\n    type: 'select',\n    label: t('Delivery Method'),\n    choices: [\n      ['email', t('Send to Email')],\n      ['slack', t('Send to Slack')],\n      ['email+slack', t('Send to Email and Slack')],\n    ],\n  },\n  reports: {\n    name: 'weekly reports',\n    type: 'blank',\n    label: t('Weekly Reports'),\n    help: t('A summary of the past week for an organization.'),\n  },\n  email: {\n    name: 'email routing',\n    type: 'blank',\n    label: t('Email Routing'),\n    help: t('Change the email address that receives notifications.'),\n  },\n  personalActivityNotifications: {\n    name: 'personalActivityNotifications',\n    type: 'boolean',\n    label: t('My Own Activity'),\n    help: t('Notifications about your own actions on Sentry.'),\n  },\n  selfAssignOnResolve: {\n    name: 'selfAssignOnResolve',\n    type: 'boolean',\n    label: t('Claim Unassigned Issues I’ve Resolved'),\n    help: t('You’ll receive notifications about any changes that happen afterwards.'),\n  },\n};\n","import React from 'react';\n\nimport AlertLink from 'app/components/alertLink';\nimport AsyncComponent from 'app/components/asyncComponent';\nimport Link from 'app/components/links/link';\nimport {IconMail} from 'app/icons';\nimport {t} from 'app/locale';\nimport {\n  CONFIRMATION_MESSAGE,\n  NOTIFICATION_SETTINGS_TYPES,\n  NotificationSettingsObject,\n  SELF_NOTIFICATION_SETTINGS_TYPES,\n} from 'app/views/settings/account/notifications/constants';\nimport FeedbackAlert from 'app/views/settings/account/notifications/feedbackAlert';\nimport {NOTIFICATION_SETTING_FIELDS} from 'app/views/settings/account/notifications/fields2';\nimport {\n  decideDefault,\n  getParentIds,\n  getStateToPutForDefault,\n  isSufficientlyComplex,\n  mergeNotificationSettings,\n} from 'app/views/settings/account/notifications/utils';\nimport Form from 'app/views/settings/components/forms/form';\nimport JsonForm from 'app/views/settings/components/forms/jsonForm';\nimport {FieldObject} from 'app/views/settings/components/forms/type';\nimport SettingsPageHeader from 'app/views/settings/components/settingsPageHeader';\nimport TextBlock from 'app/views/settings/components/text/textBlock';\n\ntype Props = AsyncComponent['props'];\n\ntype State = {\n  notificationSettings: NotificationSettingsObject;\n  legacyData: {[key: string]: string};\n} & AsyncComponent['state'];\n\nclass NotificationSettings extends AsyncComponent<Props, State> {\n  getDefaultState(): State {\n    return {\n      ...super.getDefaultState(),\n      notificationSettings: {},\n      legacyData: {},\n    };\n  }\n\n  getEndpoints(): ReturnType<AsyncComponent['getEndpoints']> {\n    return [\n      ['notificationSettings', `/users/me/notification-settings/`],\n      ['legacyData', '/users/me/notifications/'],\n    ];\n  }\n\n  getStateToPutForDefault = (\n    changedData: {[key: string]: string},\n    notificationType: string\n  ) => {\n    /**\n     * Update the current providers' parent-independent notification settings\n     * with the new value. If the new value is \"never\", then also update all\n     * parent-specific notification settings to \"default\". If the previous value\n     * was \"never\", then assume providerList should be \"email\" only.\n     */\n\n    const {notificationSettings} = this.state;\n\n    const updatedNotificationSettings = getStateToPutForDefault(\n      notificationType,\n      notificationSettings,\n      changedData,\n      getParentIds(notificationType, notificationSettings)\n    );\n\n    this.setState({\n      notificationSettings: mergeNotificationSettings(\n        notificationSettings,\n        updatedNotificationSettings\n      ),\n    });\n\n    return updatedNotificationSettings;\n  };\n\n  getInitialData(): {[key: string]: string} {\n    const {notificationSettings} = this.state;\n\n    return Object.fromEntries(\n      NOTIFICATION_SETTINGS_TYPES.map(notificationType => [\n        notificationType,\n        decideDefault(notificationType, notificationSettings),\n      ])\n    );\n  }\n\n  getFields(): FieldObject[] {\n    const {notificationSettings} = this.state;\n\n    const fields: FieldObject[] = [];\n    for (const notificationType of NOTIFICATION_SETTINGS_TYPES) {\n      const field = Object.assign({}, NOTIFICATION_SETTING_FIELDS[notificationType], {\n        getData: data => this.getStateToPutForDefault(data, notificationType),\n        help: (\n          <React.Fragment>\n            <p>\n              {NOTIFICATION_SETTING_FIELDS[notificationType].help}\n              &nbsp;\n              <Link\n                data-test-id=\"fine-tuning\"\n                to={`/settings/account/notifications/${notificationType}`}\n              >\n                Fine tune\n              </Link>\n            </p>\n          </React.Fragment>\n        ),\n      }) as any;\n\n      if (\n        isSufficientlyComplex(notificationType, notificationSettings) &&\n        typeof field !== 'function'\n      ) {\n        field.confirm = {never: CONFIRMATION_MESSAGE};\n      }\n\n      fields.push(field);\n    }\n    return fields;\n  }\n\n  renderBody() {\n    const {legacyData} = this.state;\n\n    return (\n      <React.Fragment>\n        <SettingsPageHeader title=\"Notifications\" />\n        <TextBlock>Personal notifications sent via email or an integration.</TextBlock>\n        <FeedbackAlert />\n        <Form\n          saveOnBlur\n          apiMethod=\"PUT\"\n          apiEndpoint=\"/users/me/notification-settings/\"\n          initialData={this.getInitialData()}\n        >\n          <JsonForm title={t('Notifications')} fields={this.getFields()} />\n        </Form>\n        <Form\n          initialData={legacyData}\n          saveOnBlur\n          apiMethod=\"PUT\"\n          apiEndpoint=\"/users/me/notifications/\"\n        >\n          <JsonForm\n            title={t('My Activity')}\n            fields={SELF_NOTIFICATION_SETTINGS_TYPES.map(\n              type => NOTIFICATION_SETTING_FIELDS[type] as FieldObject\n            )}\n          />\n        </Form>\n        <AlertLink to=\"/settings/account/emails\" icon={<IconMail />}>\n          {t('Looking to add or remove an email address? Use the emails panel.')}\n        </AlertLink>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default NotificationSettings;\n","import styled from '@emotion/styled';\n\nimport Avatar from 'app/components/avatar';\nimport space from 'app/styles/space';\nimport {OrganizationSummary, Project} from 'app/types';\nimport {getParentKey} from 'app/views/settings/account/notifications/utils';\n\ntype Props = {\n  notificationType: string;\n  parent: OrganizationSummary | Project;\n};\n\n// TODO(mgaeta): Infer parentKey from parent.\nconst ParentLabel = ({notificationType, parent}: Props) => (\n  <FieldLabel>\n    <Avatar\n      {...{\n        [getParentKey(notificationType)]: parent,\n      }}\n    />\n    <span>{parent.slug}</span>\n  </FieldLabel>\n);\n\nconst FieldLabel = styled('div')`\n  display: flex;\n  gap: ${space(0.5)};\n  line-height: 16px;\n`;\n\nexport default ParentLabel;\n","import set from 'lodash/set';\n\nimport {t} from 'app/locale';\nimport {OrganizationSummary, Project} from 'app/types';\nimport {\n  ALL_PROVIDERS,\n  MIN_PROJECTS_FOR_CONFIRMATION,\n  NotificationSettingsByProviderObject,\n  NotificationSettingsObject,\n  VALUE_MAPPING,\n} from 'app/views/settings/account/notifications/constants';\nimport {NOTIFICATION_SETTING_FIELDS} from 'app/views/settings/account/notifications/fields2';\nimport ParentLabel from 'app/views/settings/account/notifications/parentLabel';\nimport {FieldObject} from 'app/views/settings/components/forms/type';\n\n/**\n * Which fine-tuning parts are grouped by project\n */\nexport const isGroupedByProject = (notificationType: string): boolean =>\n  ['alerts', 'email', 'workflow'].includes(notificationType);\n\nexport const getParentKey = (notificationType: string): string => {\n  return isGroupedByProject(notificationType) ? 'project' : 'organization';\n};\n\nexport const groupByOrganization = (\n  projects: Project[]\n): Record<string, {organization: OrganizationSummary; projects: Project[]}> => {\n  return projects.reduce<\n    Record<string, {organization: OrganizationSummary; projects: Project[]}>\n  >((acc, project) => {\n    const orgSlug = project.organization.slug;\n    if (acc.hasOwnProperty(orgSlug)) {\n      acc[orgSlug].projects.push(project);\n    } else {\n      acc[orgSlug] = {\n        organization: project.organization,\n        projects: [project],\n      };\n    }\n    return acc;\n  }, {});\n};\n\nexport const getFallBackValue = (notificationType: string): string => {\n  switch (notificationType) {\n    case 'alerts':\n      return 'always';\n    case 'deploy':\n      return 'committed_only';\n    case 'workflow':\n      return 'subscribe_only';\n    default:\n      return '';\n  }\n};\n\nexport const providerListToString = (providers: string[]): string => {\n  return providers.sort().join('+');\n};\n\nexport const getChoiceString = (choices: string[][], key: string): string => {\n  if (!choices) {\n    return 'default';\n  }\n  const found = choices.find(row => row[0] === key);\n  if (!found) {\n    throw new Error(`Could not find ${key}`);\n  }\n\n  return found[1];\n};\n\n/**\n * Transform `data`, a mapping of providers to values, so that all providers in\n * `providerList` are \"on\" in the resulting object. The \"on\" value is\n * determined by checking `data` for non-\"never\" values and falling back to the\n * value `fallbackValue`. The \"off\" value is either \"default\" or \"never\"\n * depending on whether `scopeType` is \"parent\" or \"user\" respectively.\n */\nexport const backfillMissingProvidersWithFallback = (\n  data: {[key: string]: string},\n  providerList: string[],\n  fallbackValue: string,\n  scopeType: string\n): NotificationSettingsByProviderObject => {\n  // First pass: determine the fallback value.\n  const fallback = Object.values(data).reduce(\n    (previousValue, currentValue) =>\n      currentValue === 'never' ? previousValue : currentValue,\n    fallbackValue\n  );\n  // Second pass: fill in values for every provider.\n  return Object.fromEntries(\n    Object.keys(ALL_PROVIDERS).map(provider => [\n      provider,\n      providerList.includes(provider)\n        ? fallback\n        : scopeType === 'user'\n        ? 'never'\n        : 'default',\n    ])\n  );\n};\n\n/**\n * Deeply merge N notification settings objects (usually just 2).\n */\nexport const mergeNotificationSettings = (\n  ...objects: NotificationSettingsObject[]\n): NotificationSettingsObject => {\n  const output = {};\n  objects.map(settingsByType =>\n    Object.entries(settingsByType).map(([type, settingsByScopeType]) =>\n      Object.entries(settingsByScopeType).map(([scopeType, settingsByScopeId]) =>\n        Object.entries(settingsByScopeId).map(([scopeId, settingsByProvider]) => {\n          set(output, [type, scopeType, scopeId].join('.'), settingsByProvider);\n        })\n      )\n    )\n  );\n\n  return output;\n};\n\n/**\n * Get the mapping of providers to values that describe a user's parent-\n * independent notification preferences. The data from the API uses the user ID\n * rather than \"me\" so we assume the first ID is the user's.\n */\nexport const getUserDefaultValues = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject\n): NotificationSettingsByProviderObject => {\n  return (\n    Object.values(notificationSettings[notificationType]?.user || {}).pop() ||\n    Object.fromEntries(\n      Object.entries(ALL_PROVIDERS).map(([provider, value]) => [\n        provider,\n        value === 'default' ? getFallBackValue(notificationType) : value,\n      ])\n    )\n  );\n};\n\n/**\n * Get the list of providers currently active on this page. Note: this can be empty.\n */\nexport const getCurrentProviders = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject\n): string[] => {\n  const userData = getUserDefaultValues(notificationType, notificationSettings);\n\n  return Object.entries(userData)\n    .filter(([_, value]) => !['never'].includes(value))\n    .map(([provider, _]) => provider);\n};\n\n/**\n * Calculate the currently selected provider.\n */\nexport const getCurrentDefault = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject\n): string => {\n  const providersList = getCurrentProviders(notificationType, notificationSettings);\n  return providersList.length\n    ? getUserDefaultValues(notificationType, notificationSettings)[providersList[0]]\n    : 'never';\n};\n\n/**\n * For a given notificationType, are the parent-independent setting \"never\" for\n * all providers and are the parent-specific settings \"default\" or \"never\". If\n * so, the API is telling us that the user has opted out of all notifications.\n */\nexport const decideDefault = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject\n): string => {\n  const compare = (a: string, b: string): number => VALUE_MAPPING[a] - VALUE_MAPPING[b];\n\n  const parentIndependentSetting =\n    Object.values(getUserDefaultValues(notificationType, notificationSettings))\n      .sort(compare)\n      .pop() || 'never';\n\n  if (parentIndependentSetting !== 'never') {\n    return parentIndependentSetting;\n  }\n\n  const parentSpecificSetting =\n    Object.values(\n      notificationSettings[notificationType]?.[getParentKey(notificationType)] || {}\n    )\n      .flatMap(settingsByProvider => Object.values(settingsByProvider))\n      .sort(compare)\n      .pop() || 'default';\n\n  return parentSpecificSetting === 'default' ? 'never' : parentSpecificSetting;\n};\n\n/**\n * For a given notificationType, are the parent-independent setting \"never\" for\n * all providers and are the parent-specific settings \"default\" or \"never\"? If\n * so, the API is telling us that the user has opted out of all notifications.\n */\nexport const isEverythingDisabled = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject\n): boolean =>\n  ['never', 'default'].includes(decideDefault(notificationType, notificationSettings));\n\n/**\n * Extract either the list of project or organization IDs from the notification\n * settings in state. This assumes that the notification settings object is\n * fully backfilled with settings for every parent.\n */\nexport const getParentIds = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject\n): string[] =>\n  Object.keys(\n    notificationSettings[notificationType]?.[getParentKey(notificationType)] || {}\n  );\n\nexport const getParentValues = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject,\n  parentId: string\n): NotificationSettingsByProviderObject =>\n  notificationSettings[notificationType]?.[getParentKey(notificationType)]?.[\n    parentId\n  ] || {\n    email: 'default',\n  };\n\n/**\n * Get a mapping of all parent IDs to the notification setting for the current\n * providers.\n */\nexport const getParentData = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject,\n  parents: OrganizationSummary[] | Project[]\n): NotificationSettingsByProviderObject => {\n  const provider = getCurrentProviders(notificationType, notificationSettings)[0];\n\n  return Object.fromEntries(\n    parents.map(parent => [\n      parent.id,\n      getParentValues(notificationType, notificationSettings, parent.id)[provider],\n    ])\n  );\n};\n\n/**\n * Are there are more than N project or organization settings?\n */\nexport const isSufficientlyComplex = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject\n): boolean =>\n  getParentIds(notificationType, notificationSettings).length >\n  MIN_PROJECTS_FOR_CONFIRMATION;\n\n/**\n * I don't need to update the provider for EVERY once of the user's projects\n * and organizations, just the user and parents that have explicit settings.\n */\nexport const getStateToPutForProvider = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject,\n  changedData: NotificationSettingsByProviderObject\n): NotificationSettingsObject => {\n  const providerList: string[] = changedData.provider.split('+');\n  const fallbackValue = getFallBackValue(notificationType);\n\n  // If the user has no settings, we need to create them.\n  if (!Object.keys(notificationSettings).length) {\n    return {\n      [notificationType]: {\n        user: {\n          me: Object.fromEntries(providerList.map(provider => [provider, fallbackValue])),\n        },\n      },\n    };\n  }\n\n  return {\n    [notificationType]: Object.fromEntries(\n      Object.entries(notificationSettings[notificationType]).map(\n        ([scopeType, scopeTypeData]) => [\n          scopeType,\n          Object.fromEntries(\n            Object.entries(scopeTypeData).map(([scopeId, scopeIdData]) => [\n              scopeId,\n              backfillMissingProvidersWithFallback(\n                scopeIdData,\n                providerList,\n                fallbackValue,\n                scopeType\n              ),\n            ])\n          ),\n        ]\n      )\n    ),\n  };\n};\n\n/**\n * Update the current providers' parent-independent notification settings with\n * the new value. If the new value is \"never\", then also update all\n * parent-specific notification settings to \"default\". If the previous value\n * was \"never\", then assume providerList should be \"email\" only.\n */\nexport const getStateToPutForDefault = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject,\n  changedData: NotificationSettingsByProviderObject,\n  parentIds: string[]\n): NotificationSettingsObject => {\n  const newValue = Object.values(changedData)[0];\n  let providerList = getCurrentProviders(notificationType, notificationSettings);\n  if (!providerList.length) {\n    providerList = ['email'];\n  }\n\n  const updatedNotificationSettings = {\n    [notificationType]: {\n      user: {\n        me: Object.fromEntries(providerList.map(provider => [provider, newValue])),\n      },\n    },\n  };\n\n  if (newValue === 'never') {\n    updatedNotificationSettings[notificationType][getParentKey(notificationType)] =\n      Object.fromEntries(\n        parentIds.map(parentId => [\n          parentId,\n          Object.fromEntries(providerList.map(provider => [provider, 'default'])),\n        ])\n      );\n  }\n\n  return updatedNotificationSettings;\n};\n\n/**\n * Get the diff of the Notification Settings for this parent ID.\n */\nexport const getStateToPutForParent = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject,\n  changedData: NotificationSettingsByProviderObject,\n  parentId: string\n): NotificationSettingsObject => {\n  const providerList = getCurrentProviders(notificationType, notificationSettings);\n  const newValue = Object.values(changedData)[0];\n\n  return {\n    [notificationType]: {\n      [getParentKey(notificationType)]: {\n        [parentId]: Object.fromEntries(\n          providerList.map(provider => [provider, newValue])\n        ),\n      },\n    },\n  };\n};\n\n/**\n * Render each parent and add a default option to the the field choices.\n */\nexport const getParentField = (\n  notificationType: string,\n  notificationSettings: NotificationSettingsObject,\n  parent: OrganizationSummary | Project,\n  onChange: (\n    changedData: NotificationSettingsByProviderObject,\n    parentId: string\n  ) => NotificationSettingsObject\n): FieldObject => {\n  const defaultFields = NOTIFICATION_SETTING_FIELDS[notificationType];\n\n  return Object.assign({}, defaultFields, {\n    label: <ParentLabel parent={parent} notificationType={notificationType} />,\n    getData: data => onChange(data, parent.id),\n    name: parent.id,\n    choices: defaultFields.choices?.concat([\n      [\n        'default',\n        `${t('Default')} (${getChoiceString(\n          defaultFields.choices,\n          getCurrentDefault(notificationType, notificationSettings)\n        )})`,\n      ],\n    ]),\n    defaultValue: 'default',\n    help: undefined,\n  }) as any;\n};\n"],"names":["AlertLink","size","priority","icon","children","onClick","withoutMarginBottom","openInNewTab","to","href","dataTestId","StyledLink","IconWrapper","AlertLinkText","IconLink","direction","props","linkProps","omit","p","theme","alert","backgroundLight","textColor","border","space","ALL_PROVIDERS","email","slack","VALUE_MAPPING","default","never","always","subscribe_only","committed_only","MIN_PROJECTS_FOR_CONFIRMATION","MIN_PROJECTS_FOR_SEARCH","MIN_PROJECTS_FOR_PAGINATION","NOTIFICATION_SETTINGS_TYPES","SELF_NOTIFICATION_SETTINGS_TYPES","CONFIRMATION_MESSAGE","style","marginBottom","t","NOTIFICATION_SETTING_FIELDS","alerts","name","type","label","choices","help","workflow","deploy","provider","reports","personalActivityNotifications","selfAssignOnResolve","NotificationSettings","AsyncComponent","changedData","notificationType","notificationSettings","this","state","updatedNotificationSettings","getStateToPutForDefault","getParentIds","setState","mergeNotificationSettings","getDefaultState","super","legacyData","getEndpoints","getInitialData","Object","fromEntries","decideDefault","getFields","fields","field","assign","getData","data","isSufficientlyComplex","confirm","push","renderBody","title","saveOnBlur","apiMethod","apiEndpoint","initialData","ParentLabel","parent","FieldLabel","getParentKey","slug","isGroupedByProject","includes","groupByOrganization","projects","reduce","acc","project","orgSlug","organization","hasOwnProperty","getFallBackValue","providerListToString","providers","sort","join","getChoiceString","key","found","find","row","Error","backfillMissingProvidersWithFallback","providerList","fallbackValue","scopeType","fallback","values","previousValue","currentValue","keys","map","objects","output","settingsByType","entries","settingsByScopeType","settingsByScopeId","scopeId","settingsByProvider","set","getUserDefaultValues","user","pop","value","getCurrentProviders","userData","filter","_","getCurrentDefault","providersList","length","compare","a","b","parentIndependentSetting","parentSpecificSetting","flatMap","isEverythingDisabled","getParentValues","parentId","getParentData","parents","id","getStateToPutForProvider","split","scopeTypeData","scopeIdData","me","parentIds","newValue","getStateToPutForParent","getParentField","onChange","defaultFields","concat","defaultValue","undefined"],"sourceRoot":""}