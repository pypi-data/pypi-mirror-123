"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_components_events_searchBar_tsx-app_views_performance_landing_vitalsCards_tsx"],{"./app/components/events/searchBar.tsx":(e,t,s)=>{s.d(t,{Z:()=>O});var n,i=s("../node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),o=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/core-js/modules/es.string.replace.js"),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/react/index.js")),a=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),l=s("../node_modules/lodash/assign.js"),d=s.n(l),c=s("../node_modules/lodash/flatten.js"),u=s.n(c),p=s("../node_modules/lodash/isEqual.js"),m=s.n(p),h=s("../node_modules/lodash/memoize.js"),v=s.n(h),g=s("../node_modules/lodash/omit.js"),f=s.n(g),Z=s("./app/actionCreators/tags.tsx"),x=s("./app/components/smartSearchBar/index.tsx"),y=s("./app/constants/index.tsx"),j=s("./app/types/index.tsx"),b=s("./app/utils.tsx"),w=s("./app/utils/discover/fields.tsx"),_=s("./app/utils/measurements/measurements.tsx"),k=s("./app/utils/withApi.tsx"),S=s("./app/utils/withTags.tsx"),N=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const P=new RegExp("^".concat(y.c$,"|\\").concat(y.ir),"g");class C extends r.PureComponent{constructor(...e){super(...e),(0,o.Z)(this,"getEventFieldValues",v()(((e,t,s)=>{const{api:n,organization:i,projectIds:o}=this.props,r=null==o?void 0:o.map(String);return(0,w.h1)(e.key)||(0,w.Xr)(e.key)?Promise.resolve([]):(0,Z.Fo)(n,i.slug,e.key,t,r,s,!0).then((e=>u()(e.filter((({name:e})=>(0,b.ri)(e))).map((({name:e})=>e)))),(()=>{throw new Error("Unable to fetch event field values")}))}),(({key:e},t)=>"".concat(e,"-").concat(t)))),(0,o.Z)(this,"prepareQuery",(e=>e.replace(P,"")))}componentDidMount(){var e,t;null===(e=(t=this.getEventFieldValues.cache).clear)||void 0===e||e.call(t)}componentDidUpdate(e){var t,s;m()(this.props.projectIds,e.projectIds)||null===(t=(s=this.getEventFieldValues.cache).clear)||void 0===t||t.call(s)}getTagList(e){const{fields:t,organization:s,tags:n,omitTags:i}=this.props,o=t?Object.fromEntries(t.filter((e=>!Object.keys(w.wZ).includes(e.field)&&!(0,w.GO)(e.field))).map((e=>[e.field,{key:e.field,name:e.field}]))):{},r=s.features.includes("performance-view")?Object.assign({},e,w.wZ,o):f()(w.wZ,w.J8),a=s.features.includes("semver")?Object.assign({},w.jg,r):r,l=d()({},n,a);return l.has={key:"has",name:"Has property",values:Object.keys(l),predefined:!0},f()(l,null!=i?i:[])}render(){const{organization:e}=this.props;return(0,N.tZ)(_.Z,{organization:e,children:({measurements:e})=>{const t=this.getTagList(e);return(0,N.tZ)(a.ms,{children:({css:e})=>(0,N.tZ)(x.Z,{hasRecentSearches:!0,savedSearchType:j.L4.EVENT,onGetTagValues:this.getEventFieldValues,supportedTags:t,prepareQuery:this.prepareQuery,excludeEnvironment:!0,dropdownClassName:e(n||(n=(0,i.Z)(["\n                    max-height: 300px;\n                    overflow-y: auto;\n                  "]))),...this.props})})}})}}C.displayName="SearchBar";const O=(0,k.Z)((0,S.Z)(C))},"./app/utils/measurements/measurements.tsx":(e,t,s)=>{s.d(t,{Z:()=>c}),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var n=s("../node_modules/react/index.js"),i=s("./app/utils/performance/vitals/constants.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function r(e){return Object.fromEntries(Object.entries(e).map((([e,t])=>[e,{name:t.name,key:e}])))}const a=r(i.T),l=r(i.r);function d({organization:e,children:t}){const s=e.features.includes("performance-mobile-vitals")?{...l,...a}:l;return(0,o.tZ)(n.Fragment,{children:t({measurements:s})})}d.displayName="Measurements";const c=d},"./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx":(e,t,s)=>{s.d(t,{Z:()=>u}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js");var n=s("../node_modules/lodash/pick.js"),i=s.n(n),o=s("./app/utils/discover/genericDiscoverQuery.tsx"),r=s("./app/utils/performance/constants.tsx"),a=s("./app/utils/withApi.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){const{eventView:t,vitals:s}=e,n=null==t?void 0:t.getEventsAPIPayload(e.location);return{vital:s,...i()(n,["query",...Object.values(r.s)])}}function c(e){return(0,l.tZ)(o.ZP,{getRequestPayload:d,route:"events-vitals",...e,children:({tableData:t,...s})=>e.children({vitalsData:t,...s})})}c.displayName="VitalsCardsDiscoverQuery";const u=(0,a.Z)(c)},"./app/utils/withTags.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var n=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),o=s("./app/stores/tagStore.tsx"),r=s("./app/utils/getDisplayName.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=function(e){class t extends i.Component{constructor(...e){super(...e),(0,n.Z)(this,"state",{tags:o.Z.getAllTags()}),(0,n.Z)(this,"unsubscribe",o.Z.listen((e=>this.setState({tags:e})),void 0))}componentWillUnmount(){this.unsubscribe()}render(){const{tags:t,...s}=this.props;return(0,a.tZ)(e,{tags:null!=t?t:this.state.tags,...s})}}return t.displayName="WithTags",(0,n.Z)(t,"displayName","withTags(".concat((0,r.Z)(e),")")),t}},"./app/views/performance/landing/vitalsCards.tsx":(e,t,s)=>{s.d(t,{M9:()=>W,q7:()=>H,aU:()=>J,JO:()=>ee});var n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=(s("../node_modules/core-js/modules/es.symbol.description.js"),s("../node_modules/react/index.js")),o=s("../node_modules/@sentry/minimal/esm/index.js"),r=s("./app/components/card.tsx"),a=s("./app/components/charts/eventsRequest.tsx"),l=s("./app/components/charts/styles.tsx"),d=s("./app/components/charts/utils.tsx"),c=s("./app/components/emptyStateWarning.tsx"),u=s("./app/components/links/link.tsx"),p=s("./app/components/placeholder.tsx"),m=s("./app/components/questionTooltip.tsx"),h=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),v=s("../node_modules/react-sparklines/build/index.js"),g=s("../node_modules/prop-types/index.js"),f=s.n(g);class Z extends v.Sparklines{}(0,h.Z)(Z,"propTypes",{children:f().node,data:f().array,limit:f().number,width:f().number,height:f().number,svgWidth:f().number,svgHeight:f().number,preserveAspectRatio:f().string,margin:f().number,style:f().object,min:f().number,max:f().number,onMouseMove:f().func});var x=s("./app/locale.tsx"),y=s("./app/styles/overflowEllipsis.tsx"),j=s("./app/styles/space.tsx"),b=s("./app/utils.tsx"),w=s("./app/utils/dates.tsx"),_=s("./app/utils/discover/discoverQuery.tsx"),k=s("./app/utils/discover/fields.tsx"),S=s("./app/utils/performance/vitals/constants.tsx"),N=s("./app/utils/performance/vitals/vitalsCardsDiscoverQuery.tsx"),P=s("./app/utils/queryString.tsx"),C=s("./app/utils/theme.tsx"),O=s("./app/utils/useApi.tsx"),A=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const E=e=>(0,A.tZ)(z,{fractions:e.colorStops.map((({percent:e})=>e)),children:e.colorStops.map((e=>(0,A.tZ)(D,{color:e.color},e.color)))});E.displayName="ColorBar";const z=(0,n.Z)("div",{target:"etd41501"})("height:16px;width:100%;overflow:hidden;position:relative;background:",(e=>e.theme.gray100),";display:grid;grid-template-columns:",(e=>e.fractions.map((e=>"".concat(e,"fr"))).join(" ")),";margin-bottom:",(0,j.Z)(1),";border-radius:2px;"),D=(0,n.Z)("div",{target:"etd41500"})("background-color:",(e=>e.theme[e.color]),";"),T=E;var V=s("./app/views/performance/vitalDetail/utils.tsx"),B=s("./app/components/tooltip.tsx"),L=s("./app/utils/formatters.tsx");function M(e,t){const s=Array.isArray(e)||e===k.Zl.CLS?"":"ms";switch(t){case V.SP.POOR:return Array.isArray(e)?(0,x.t)("Poor"):(0,x._N)("Poor: >[threshold][unit]",{threshold:V.eE[e],unit:s});case V.SP.MEH:return Array.isArray(e)?(0,x.t)("Meh"):(0,x._N)("Meh: >[threshold][unit]",{threshold:V.MN[e],unit:s});case V.SP.GOOD:return Array.isArray(e)?(0,x.t)("Good"):(0,x._N)("Good: <[threshold][unit]",{threshold:V.MN[e],unit:s});default:return null}}function F(e){return(0,A.tZ)(q,{children:e.percents.map((t=>(0,A.tZ)(B.Z,{title:M(e.vital,t.vitalState),children:(0,A.BX)(I,{children:[V.Np[t.vitalState],(0,A.BX)("span",{children:[e.showVitalPercentNames&&(0,x.t)("".concat(t.vitalState))," ",(0,L.rl)(t.percent,0)]})]})},t.vitalState)))})}F.displayName="VitalPercents";const q=(0,n.Z)("div",{target:"ex3thpn1"})("display:inline-grid;grid-auto-flow:column;gap:",(0,j.Z)(2),";"),I=(0,n.Z)("div",{target:"ex3thpn0"})("display:flex;align-items:center;gap:",(0,j.Z)(.5),";font-size:",(e=>e.theme.fontSizeMedium),";");var G=s("./app/views/performance/landing/utils.tsx");function H(e){const{eventView:t,location:s,organization:n,projects:i,frontendOnly:o=!1}=e;if(o&&(0,G.Oo)(i,t)!==G.BY.FRONTEND_PAGELOAD)return null;const r=[k.Zl.FCP,k.Zl.LCP,k.Zl.FID,k.Zl.CLS];return(0,A.tZ)(N.Z,{eventView:t,location:s,orgSlug:n.slug,vitals:r,children:({isLoading:e,vitalsData:i})=>(0,A.tZ)(K,{children:r.map((o=>{var r,a,l;const d=(0,V.i4)({orgSlug:n.slug,query:t.generateQueryStringObject(),vitalName:o,projectID:(0,P.qP)(s.query.project)}),c=e?"—":oe(null!==(r=null==i?void 0:i[o])&&void 0!==r?r:null,o),p=(0,A.tZ)(Q,{children:(0,A.tZ)(ee,{isLoading:e,vital:o,data:i})});return(0,A.tZ)(u.Z,{to:d,"data-test-id":"vitals-linked-card-".concat(V.a7[o]),children:(0,A.tZ)(se,{title:null!==(a=V.jo[o])&&void 0!==a?a:"",tooltip:null!==(l=S.r[o].description)&&void 0!==l?l:"",value:e?"—":c,chart:p,minHeight:150})},o)}))})})}H.displayName="FrontendCards";const Q=(0,n.Z)("div",{target:"e1he14ku8"})("margin-top:",(0,j.Z)(1.5),";");function X(e){const t=(0,O.Z)(),{eventView:s,location:n,organization:i,functions:r}=e,{query:l}=n,c=s.withColumns(r),u=c.getGlobalSelection(),p=u.datetime.start?(0,w.hC)(u.datetime.start):void 0,m=u.datetime.end?(0,w.hC)(u.datetime.end):void 0,h="string"==typeof l.sparkInterval?l.sparkInterval:(0,d.ZS)({start:p||null,end:m||null,period:u.datetime.period},"low"),v=c.getEventsAPIPayload(n);return(0,A.tZ)(_.Z,{location:n,eventView:c,orgSlug:i.slug,limit:1,referrer:"api.performance.vitals-cards",children:({isLoading:e,tableData:s})=>(0,A.tZ)(a.Z,{api:t,organization:i,period:u.datetime.period,project:u.projects,environment:u.environments,team:v.team,start:p,end:m,interval:h,query:v.query,includePrevious:!1,yAxis:c.getFields(),partial:!0,children:({results:t})=>{const n=null==t?void 0:t.reduce(((e,t)=>(e[t.seriesName]=t.data.map((e=>e.value)),e)),{}),a=(0,G.hv)(i);return(0,A.tZ)(K,{children:r.map((t=>{var i,r;let l=(0,k.sN)(t);l.includes("apdex")&&(l="apdex()");const d=a[l];if(!d)return o.uT("Missing field '".concat(l,"' in vital cards.")),null;const{title:c,tooltip:u,formatter:p}=d,m=(0,k.LY)(l),h=null==s||null===(i=s.data)||void 0===i||null===(r=i[0])||void 0===r?void 0:r[m],v=null==n?void 0:n[l],g=e||!(0,b.ri)(h)?"—":p(h),f=(0,A.tZ)(Y,{data:v});return(0,A.tZ)(se,{title:c,tooltip:u,value:g,chart:f,horizontal:!0,minHeight:96,isNotInteractive:!0},l)}))})}})})}function R(e){return(0,A.tZ)(X,{...e,functions:[{kind:"function",function:["p75","transaction.duration",void 0,void 0]},{kind:"function",function:["tpm","",void 0,void 0]},{kind:"function",function:["failure_rate","",void 0,void 0]},{kind:"function",function:["apdex","",void 0,void 0]}]})}X.displayName="GenericCards",R.displayName="_BackendCards";const W=R;function U(e){const t=[{kind:"function",function:["p75","measurements.app_start_cold",void 0,void 0]},{kind:"function",function:["p75","measurements.app_start_warm",void 0,void 0]}];return e.showStallPercentage?t.push({kind:"function",function:["p75","measurements.stall_percentage",void 0,void 0]}):(t.push({kind:"function",function:["p75","measurements.frames_slow_rate",void 0,void 0]}),t.push({kind:"function",function:["p75","measurements.frames_frozen_rate",void 0,void 0]})),(0,A.tZ)(X,{...e,functions:t})}U.displayName="_MobileCards";const J=U;function Y(e){const{data:t}=e,s=C.ZP.charts.getColorPalette(1)[0];return(0,A.tZ)($,{"data-test-id":"sparkline",width:150,height:24,children:(0,A.tZ)(Z,{data:t,width:150,height:24,children:(0,A.tZ)(v.SparklinesLine,{style:{stroke:s,fill:"none",strokeWidth:3}})})})}Y.displayName="SparklineChart";const $=(0,n.Z)("div",{target:"e1he14ku7"})("flex-grow:4;max-height:",(e=>e.height),"px;max-width:",(e=>e.width),"px;margin:",(0,j.Z)(1)," ",(0,j.Z)(0)," ",(0,j.Z)(.5)," ",(0,j.Z)(3),";"),K=(0,n.Z)("div",{target:"e1he14ku6"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,j.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(e=>e.theme.breakpoints[2]),"){grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));}");function ee(e){var t;const{isLoading:s,data:n,vital:o,value:r,showBar:a=!0,showStates:l=!1,showDurationDetail:d=!1,showVitalPercentNames:c=!1}=e;if(s)return l?(0,A.tZ)(p.Z,{height:"48px"}):null;const u=l?(0,A.tZ)(te,{small:!0,children:(0,x.t)("No vitals found")}):null;if(!n)return u;const m={poor:0,meh:0,good:0,total:0};if((Array.isArray(o)?o:[o]).forEach((e=>{var t;const s=null!==(t=null==n?void 0:n[e])&&void 0!==t?t:{};Object.keys(m).forEach((e=>m[e]+=s[e]))})),!m.total)return u;const h=Array.isArray(o)?null:null!=r?r:oe(null!==(t=null==n?void 0:n[o])&&void 0!==t?t:null,o),v=function({poor:e,meh:t,good:s,total:n}){const i=e/n,o=t/n,r=s/n;return[{vitalState:V.SP.GOOD,percent:r},{vitalState:V.SP.MEH,percent:o},{vitalState:V.SP.POOR,percent:i}]}(m),g=function(e){return e.map((({percent:e,vitalState:t})=>({percent:e,color:V.fL[t]})))}(v);return(0,A.BX)(i.Fragment,{children:[a&&(0,A.tZ)(T,{colorStops:g}),(0,A.BX)(re,{children:[d&&h&&(0,A.BX)("div",{"data-test-id":"vital-bar-p75",children:[(0,x.t)("The p75 for all transactions is "),(0,A.tZ)("strong",{children:h})]}),(0,A.tZ)(F,{vital:o,percents:v,showVitalPercentNames:c})]})]})}ee.displayName="VitalBar";const te=(0,n.Z)(c.Z,{target:"e1he14ku5"})("height:48px;padding:",(0,j.Z)(1.5)," 15%;");function se(e){const{chart:t,minHeight:s,horizontal:n,title:i,tooltip:o,value:r,isNotInteractive:a}=e;return(0,A.BX)(ie,{interactive:!a,minHeight:s,children:[(0,A.BX)(l.Gh,{children:[(0,A.tZ)(le,{children:(0,x.t)(i)}),(0,A.tZ)(m.Z,{size:"sm",position:"top",title:o})]}),(0,A.BX)(ne,{horizontal:n,children:[(0,A.tZ)(ae,{children:r}),t]})]})}se.displayName="VitalCard";const ne=(0,n.Z)("div",{target:"e1he14ku4"})("width:100%;display:flex;flex-direction:",(e=>e.horizontal?"row":"column"),";justify-content:space-between;"),ie=(0,n.Z)(r.Z,{target:"e1he14ku3"})("color:",(e=>e.theme.textColor),";padding:",(0,j.Z)(2)," ",(0,j.Z)(3),";align-items:flex-start;margin-bottom:",(0,j.Z)(2),";",(e=>e.minHeight&&"min-height: ".concat(e.minHeight,"px")),";");function oe(e,t){var s;const n=null!==(s=null==e?void 0:e.p75)&&void 0!==s?s:null;return null===n?"—":t===k.Zl.CLS?n.toFixed(2):"".concat(n.toFixed(0),"ms")}const re=(0,n.Z)("div",{target:"e1he14ku2"})("font-size:",(e=>e.theme.fontSizeMedium),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){display:flex;justify-content:space-between;}"),ae=(0,n.Z)("div",{target:"e1he14ku1"})("font-size:32px;margin-top:",(0,j.Z)(1),";"),le=(0,n.Z)("div",{target:"e1he14ku0"})(y.Z,";")}}]);
//# sourceMappingURL=../sourcemaps/app_components_events_searchBar_tsx-app_views_performance_landing_vitalsCards_tsx.e812b77a8bcb42cdb50db98000dc3fa8.js.map