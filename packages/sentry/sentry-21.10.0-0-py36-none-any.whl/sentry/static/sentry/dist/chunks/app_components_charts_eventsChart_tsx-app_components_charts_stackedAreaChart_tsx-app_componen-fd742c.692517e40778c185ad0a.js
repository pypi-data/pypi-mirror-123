"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_components_charts_eventsChart_tsx-app_components_charts_stackedAreaChart_tsx-app_componen-fd742c"],{"./app/actionCreators/events.tsx":(e,t,s)=>{s.d(t,{lI:()=>l,eV:()=>d,JE:()=>p}),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/lodash/pick.js"),o=s.n(r),a=s("./app/components/charts/utils.tsx"),n=s("./app/utils/getPeriod.tsx"),i=s("./app/utils/performance/constants.tsx");const l=(e,{organization:t,project:s,environment:r,team:o,period:i,start:l,end:d,interval:p,comparisonDelta:c,includePrevious:u,query:m,yAxis:h,field:g,topEvents:v,orderby:f,partial:x,withoutZerofill:y,referrer:S})=>{const b=(0,a.Sw)(u,i),P=Object.fromEntries(Object.entries({interval:p,comparisonDelta:c,project:s,environment:r,team:o,query:m,yAxis:h,field:g,topEvents:v,orderby:f,partial:x?"1":void 0,withoutZerofill:y?"1":void 0,referrer:S||"api.organization-event-stats"}).filter((([,e])=>void 0!==e))),Z=(0,n.X)({period:i,start:l,end:d},{shouldDoublePeriod:b});return e.requestPromise("/organizations/".concat(t.slug,"/events-stats/"),{query:{...P,...Z}})};async function d(e,t,s){const r={...o()(s,Object.values(i.s)),query:s.query};return e.requestPromise("/organizations/".concat(t,"/events-facets/"),{query:r})}async function p(e,t,s){const r={...o()(s,Object.values(i.s)),query:s.query};return e.requestPromise("/organizations/".concat(t,"/events-meta/"),{query:r}).then((e=>e.count))}},"./app/components/charts/areaChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>l});var r=s("../node_modules/react/index.js"),o=s("./app/components/charts/series/lineSeries.tsx"),a=s("./app/components/charts/baseChart.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends r.Component{render(){const{series:e,stacked:t,colors:s,...r}=this.props;return(0,n.tZ)(a.Z,{...r,colors:s,series:e.map((({seriesName:e,data:r,...a},n)=>function(e={}){return(0,o.Z)({...e})}({stack:t?"area":void 0,name:e,data:r.map((({name:e,value:t})=>[e,t])),lineStyle:{color:null==s?void 0:s[n],opacity:1,width:.4},areaStyle:{color:null==s?void 0:s[n],opacity:1},animation:!1,animationThreshold:1,animationDuration:0,...a})))})}}i.displayName="AreaChart";const l=i},"./app/components/charts/components/markLine.tsx":(e,t,s)=>{function r(e){return{symbol:["none","none"],...e}}s.d(t,{Z:()=>r}),s("../node_modules/echarts/lib/component/markLine.js")},"./app/components/charts/eventsChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>R});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),n=s("../node_modules/lodash/isEqual.js"),i=s.n(n),l=s("./app/components/charts/areaChart.tsx"),d=s("./app/components/charts/barChart.tsx"),p=s("./app/components/charts/chartZoom.tsx"),c=s("./app/components/charts/errorPanel.tsx"),u=s("./app/components/charts/lineChart.tsx"),m=s("./app/components/charts/releaseSeries.tsx"),h=s("./app/components/charts/transitionChart.tsx"),g=s("./app/components/charts/transparentLoadingMask.tsx"),v=s("./app/components/charts/utils.tsx"),f=s("./app/icons/index.tsx"),x=s("./app/locale.tsx"),y=s("./app/utils.tsx"),S=s("./app/utils/discover/charts.tsx"),b=s("./app/utils/discover/fields.tsx"),P=s("./app/utils/queryString.tsx"),Z=s("./app/components/charts/eventsRequest.tsx"),D=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class j extends o.Component{constructor(...e){super(...e),(0,r.Z)(this,"state",{seriesSelection:{},forceUpdate:!1}),(0,r.Z)(this,"handleLegendSelectChanged",(e=>{const{disableableSeries:t=[]}=this.props,{selected:s}=e,r=Object.keys(s).reduce(((e,r)=>{const o=["Releases","Other"].includes(r)||t.includes(r);return e[r]=!o||s[r],e}),{});this.setState({seriesSelection:r,forceUpdate:!0},(()=>this.setState({forceUpdate:!1})))}))}shouldComponentUpdate(e,t){return!(!t.forceUpdate&&i()(this.state.seriesSelection,t.seriesSelection)&&(e.reloading||!e.timeseriesData||i()(this.props.timeseriesData,e.timeseriesData)&&i()(this.props.releaseSeries,e.releaseSeries)&&i()(this.props.previousTimeseriesData,e.previousTimeseriesData)))}getChartComponent(){const{showDaily:e,timeseriesData:t,yAxis:s,chartComponent:r}=this.props;if((0,y.ri)(r))return r;if(e)return d.Z;if(t.length>1)switch((0,b.fD)(s)){case"line":return u.Z;case"area":return l.Z;default:throw new Error("Unknown multi plot type for ".concat(s))}return l.Z}render(){var e,t;const{theme:s,loading:r,reloading:o,yAxis:a,releaseSeries:n,zoomRenderProps:i,timeseriesData:l,previousTimeseriesData:d,showLegend:p,legendOptions:c,chartOptions:u,currentSeriesNames:m,previousSeriesNames:h,seriesTransformer:g,previousSeriesTransformer:f,colors:y,height:b,timeframe:P,topEvents:Z,...j}=this.props,{seriesSelection:w}=this.state,_=[...m.length>0?m:[(0,x.t)("Current")],...h.length>0?h:[(0,x.t)("Previous")]],R=(0,x.t)("Releases"),C=Z&&Z+1===l.length;C&&_.push("Other"),Array.isArray(n)&&_.push(R);const E=n&&n[0],A=Array.isArray(n)&&(null==E||null===(e=E.markLine)||void 0===e?void 0:e.data)&&E.markLine.data.length>=v.XO,q=Array.isArray(n)&&0===Object.keys(w).length&&A?{[R]:!1}:w,N=p?{right:16,top:12,data:_,selected:q,...null!=c?c:{}}:void 0;let T=Array.isArray(n)?[...l,...n]:l,k=d;var O;g&&(T=g(T)),f&&(k=null===(O=k)||void 0===O?void 0:O.map((e=>f(e))));const L=l.length?null!==(t=null==y?void 0:y.slice(0,T.length))&&void 0!==t?t:[...s.charts.getColorPalette(l.length-2-(C?1:0))]:void 0;L&&L.length&&C&&L.push(s.chartOther);const z={colors:L,grid:{left:"24px",right:"24px",top:"32px",bottom:"12px"},seriesOptions:{showSymbol:!1},tooltip:{trigger:"axis",truncate:80,valueFormatter:e=>(0,S.CX)(e,a)},xAxis:P?{min:P.start,max:P.end}:void 0,yAxis:{axisLabel:{color:s.chartLabel,formatter:e=>(0,S.gu)(e,a)}},...null!=u?u:{}},I=this.getChartComponent();return(0,D.tZ)(I,{...j,...i,...z,legend:N,onLegendSelectChanged:this.handleLegendSelectChanged,series:T,previousPeriod:k||void 0,height:b})}}j.displayName="Chart";const w=(0,a.b)(j);class _ extends o.Component{isStacked(){const{topEvents:e,yAxis:t}=this.props;return"number"==typeof e&&e>0||Array.isArray(t)&&t.length>1}render(){const{api:e,period:t,utc:s,query:r,router:a,start:n,end:i,projects:l,environments:d,showLegend:u,yAxis:y,disablePrevious:S,disableReleases:j,emphasizeReleases:_,currentSeriesName:R,previousSeriesName:C,seriesTransformer:E,previousSeriesTransformer:A,field:q,interval:N,showDaily:T,topEvents:k,orderby:O,confirmedQuery:L,colors:z,chartHeader:I,legendOptions:F,chartOptions:M,preserveReleaseQueryParams:G,releaseQueryExtra:U,disableableSeries:V,chartComponent:W,usePageZoom:B,height:H,withoutZerofill:Q,...X}=this.props,Y=!S&&!n&&!i,J=(0,P.qP)(y),K=J.map((e=>{let t=e&&(0,b.GO)(e)?(0,b.vp)(e):e;return t&&t.length>60&&(t=t.substr(0,60)+"..."),t})),$=C?[C]:K.map((e=>(0,x.t)("previous %s",e))),ee=R?[R]:K,te=T?"1d":N||(0,v.ZS)(this.props,"high");let se=({zoomRenderProps:e,releaseSeries:t,errored:s,loading:r,reloading:a,results:n,timeseriesData:i,previousTimeseriesData:l,timeframe:d})=>{if(s)return(0,D.tZ)(c.Z,{children:(0,D.tZ)(f.FC,{color:"gray300",size:"lg"})});const p=n||i;return(0,D.BX)(h.Z,{loading:r,reloading:a,height:H?"".concat(H,"px"):void 0,children:[(0,D.tZ)(g.Z,{visible:a}),o.isValidElement(I)&&I,(0,D.tZ)(w,{zoomRenderProps:e,loading:r,reloading:a,showLegend:u,releaseSeries:t||[],timeseriesData:null!=p?p:[],previousTimeseriesData:l,currentSeriesNames:ee,previousSeriesNames:$,seriesTransformer:E,previousSeriesTransformer:A,stacked:this.isStacked(),yAxis:J[0],showDaily:T,colors:z,legendOptions:F,chartOptions:M,disableableSeries:V,chartComponent:W,height:H,timeframe:d,topEvents:k})]})};if(!j){const e=se;se=r=>(0,D.tZ)(m.Z,{utc:s,period:t,start:n,end:i,projects:l,environments:d,emphasizeReleases:_,preserveQueryParams:G,queryExtra:U,children:({releaseSeries:t})=>e({...r,releaseSeries:t})})}return(0,D.tZ)(p.Z,{router:a,period:t,start:n,end:i,utc:s,usePageDate:B,...X,children:s=>(0,D.tZ)(Z.Z,{...X,api:e,period:t,project:l,environment:d,start:n,end:i,interval:te,query:r,includePrevious:Y,currentSeriesNames:ee,previousSeriesNames:$,yAxis:y,field:q,orderby:O,topEvents:k,confirmedQuery:L,partial:!0,withoutZerofill:Q&&!this.isStacked(),children:e=>se({...e,zoomRenderProps:s})})})}}_.displayName="EventsChart";const R=_},"./app/components/charts/eventsRequest.tsx":(e,t,s)=>{s.d(t,{Z:()=>y});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("../node_modules/lodash/isEqual.js"),n=s.n(a),i=s("../node_modules/lodash/omitBy.js"),l=s.n(i),d=s("./app/actionCreators/events.tsx"),p=s("./app/actionCreators/indicator.tsx"),c=s("./app/components/charts/loadingPanel.tsx"),u=s("./app/components/charts/utils.tsx"),m=s("./app/locale.tsx"),h=s("./app/utils/discover/fields.tsx"),g=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const v=["api","children","organization","loading"],f=e=>l()(e,((e,t)=>v.includes(t)));class x extends o.PureComponent{constructor(...e){super(...e),(0,r.Z)(this,"state",{reloading:!!this.props.loading,errored:!1,timeseriesData:null,fetchedWithPrevious:!1}),(0,r.Z)(this,"unmounting",!1),(0,r.Z)(this,"fetchData",(async()=>{const{api:e,confirmedQuery:t,expired:s,name:r,hideError:o,...a}=this.props;let n=null;if(!1!==t){if(this.setState((e=>({reloading:null!==e.timeseriesData,errored:!1}))),s)(0,p.Iw)((0,m.t)("%s has an invalid date range. Please try a more recent date range.",r),{append:!0}),this.setState({errored:!0});else try{e.clear(),n=await(0,d.lI)(e,a)}catch(e){o||(e&&e.responseJSON&&e.responseJSON.detail?(0,p.Iw)(e.responseJSON.detail):(0,p.Iw)((0,m.t)("Error loading chart data"))),this.setState({errored:!0})}this.unmounting||this.setState({reloading:!1,timeseriesData:n,fetchedWithPrevious:a.includePrevious})}})),(0,r.Z)(this,"getData",(e=>{const{fetchedWithPrevious:t}=this.state,{period:s,includePrevious:r}=this.props,o=t||(0,u.Sw)(r,s),a=Math.floor(e.length/2);return{current:o?e.slice(a):e,previous:o?e.slice(0,a):null}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){n()(f(e),f(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}calculateTotalsPerTimestamp(e,t=(e=>1e3*e)){return e.map((([e,s],r)=>({name:t(e,s,r),value:s.reduce(((e,{count:t})=>e+t),0)})))}transformPreviousPeriodData(e,t,s){return t?{seriesName:null!=s?s:"Previous",data:this.calculateTotalsPerTimestamp(t,((t,s,r)=>1e3*e[r][0])),stack:"previous"}:null}transformAggregatedTimeseries(e,t=""){return{seriesName:t,data:this.calculateTotalsPerTimestamp(e)}}transformTimeseriesData(e,t){return[{seriesName:t||"Current",data:e.map((([e,t])=>({name:1e3*e,value:t.reduce(((e,{count:t})=>e+t),0)})))}]}transformComparisonTimeseriesData(e){return[{seriesName:"comparisonCount()",data:e.map((([e,t])=>({name:1e3*e,value:t.reduce(((e,{comparisonCount:t})=>e+(null!=t?t:0)),0)})))}]}processData(e,t=0,s){var r;const{data:o,totals:a}=e,{includeTransformedData:n,includeTimeAggregation:i,timeAggregationSeriesName:l,currentSeriesNames:d,previousSeriesNames:p,comparisonDelta:c}=this.props,{current:u,previous:m}=this.getData(o);return{data:n?this.transformTimeseriesData(u,null!=s?s:null==d?void 0:d[t]):[],comparisonData:n&&c?this.transformComparisonTimeseriesData(u):[],allData:o,originalData:u,totals:a,originalPreviousData:m,previousData:n?this.transformPreviousPeriodData(u,m,null!==(r=s?"previous ".concat(s):void 0)&&void 0!==r?r:null==p?void 0:p[t]):null,timeAggregatedData:i?this.transformAggregatedTimeseries(u,l||""):{},timeframe:e.start&&e.end?m?{start:500*(e.start+e.end),end:1e3*e.end}:{start:1e3*e.start,end:1e3*e.end}:void 0}}render(){const{children:e,showLoading:t,...s}=this.props,{timeseriesData:r,reloading:o,errored:a}=this.state,n=this.props.loading||null===r;if(t&&n)return(0,g.tZ)(c.Z,{"data-test-id":"events-request-loading"});if((0,u.Xe)(r)){let t;const i=Object.keys(r).map(((e,s)=>{const o=r[e],a=this.processData(o,s,(0,h.bQ)(e));return t||(t=a.timeframe),[o.order||0,a.data[0],a.previousData]})).sort(((e,t)=>e[0]-t[0])),l=i.map((e=>e[1])),d=i.some((e=>null===e[2]))?void 0:i.map((e=>e[2]));return e({loading:n,reloading:o,errored:a,results:l,timeframe:t,previousTimeseriesData:d,...s})}if(r){const{data:t,comparisonData:i,allData:l,originalData:d,totals:p,originalPreviousData:c,previousData:u,timeAggregatedData:m,timeframe:h}=this.processData(r);return e({loading:n,reloading:o,errored:a,timeseriesData:t,comparisonTimeseriesData:i,allTimeseriesData:l,originalTimeseriesData:d,timeseriesTotals:p,originalPreviousTimeseriesData:c,previousTimeseriesData:u?[u]:u,timeAggregatedData:m,timeframe:h,...s})}return e({loading:n,reloading:o,errored:a,...s})}}x.displayName="EventsRequest",(0,r.Z)(x,"defaultProps",{period:void 0,start:null,end:null,interval:"1d",comparisonDelta:void 0,limit:15,query:"",includePrevious:!0,includeTransformedData:!0});const y=x},"./app/components/charts/releaseSeries.tsx":(e,t,s)=>{s.d(t,{Z:()=>D});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("../node_modules/react-router/es/index.js"),n=s("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),i=s("../node_modules/lodash/isEqual.js"),l=s.n(i),d=s("../node_modules/lodash/memoize.js"),p=s.n(d),c=s("../node_modules/lodash/partition.js"),u=s.n(c),m=s("./app/actionCreators/indicator.tsx"),h=s("./app/components/charts/components/markLine.tsx"),g=s("./app/locale.tsx"),v=s("./app/utils.tsx"),f=s("./app/utils/dates.tsx"),x=s("./app/utils/formatters.tsx"),y=s("./app/utils/parseLinkHeader.tsx"),S=s("./app/utils/withApi.tsx"),b=s("./app/utils/withOrganization.tsx");function P(e,t,s){const r={};return Object.keys(s).forEach((e=>{let t=s[e];!t||"start"!==e&&"end"!==e||(t=(0,f.v5)(t)),t&&(r[e]=t)})),e.clear(),e.requestPromise("/organizations/".concat(t.slug,"/releases/stats/"),{includeAllArgs:!0,method:"GET",query:r})}class Z extends o.Component{constructor(...e){super(...e),(0,r.Z)(this,"state",{releases:null,releaseSeries:[]}),(0,r.Z)(this,"_isMounted",!1),(0,r.Z)(this,"getOrganizationReleasesMemoized",p()(((e,t,s)=>P(e,t,s)),((e,t,s)=>Object.values(s).map((e=>JSON.stringify(e))).join("-")))),(0,r.Z)(this,"getReleaseSeries",((e,t={})=>{const{organization:s,router:r,tooltip:o,environments:a,start:n,end:i,period:l,preserveQueryParams:d,queryExtra:p,theme:c}=this.props,u={...p};s.features.includes("global-views")&&(u.project=r.location.query.project),d&&(u.environment=[...a],u.start=n?(0,f.v5)(n):void 0,u.end=i?(0,f.v5)(i):void 0,u.statsPeriod=l||void 0);const m=(0,h.Z)({animation:!1,lineStyle:{color:c.purple300,opacity:.3,type:"solid",...t},label:{show:!1},data:e.map((e=>({xAxis:+new Date(e.date),name:(0,x.ko)(e.version,!0),value:(0,x.ko)(e.version,!0),onClick:()=>{r.push({pathname:"/organizations/".concat(s.slug,"/releases/").concat(e.version,"/"),query:u})},label:{formatter:()=>(0,x.ko)(e.version,!0)}})))});return m.tooltip=o||{trigger:"item",formatter:({data:e})=>{const t=(0,f.L0)(e.value,"MMM D, YYYY LT",{local:!this.props.utc}),s=(0,v.YU)((0,x.ko)(e.name,!0));return['<div class="tooltip-series">','<div><span class="tooltip-label"><strong>'.concat((0,g.t)("Release"),"</strong></span> ").concat(s,"</div>"),"</div>",'<div class="tooltip-date">',t,"</div>","</div>",'<div class="tooltip-arrow"></div>'].join("")}},{seriesName:"Releases",color:c.purple200,data:[],markLine:m}}))}componentDidMount(){this._isMounted=!0;const{releases:e}=this.props;e?this.setReleasesWithSeries(e):this.fetchData()}componentDidUpdate(e){l()(e.projects,this.props.projects)&&l()(e.environments,this.props.environments)&&l()(e.start,this.props.start)&&l()(e.end,this.props.end)&&l()(e.period,this.props.period)&&l()(e.query,this.props.query)?l()(e.emphasizeReleases,this.props.emphasizeReleases)||this.setReleasesWithSeries(this.state.releases):this.fetchData()}componentWillUnmount(){this._isMounted=!1,this.props.api.clear()}async fetchData(){const{api:e,organization:t,projects:s,environments:r,period:o,start:a,end:n,memoized:i,query:l}=this.props,d={start:a,end:n,project:s,environment:r,statsPeriod:o,query:l};let p=!0;const c=[];for(;p;)try{const s=i?this.getOrganizationReleasesMemoized:P,[r,,o]=await s(e,t,d);c.push(...r),this._isMounted&&this.setReleasesWithSeries(c);const a=null==o?void 0:o.getResponseHeader("Link");if(a){var u,h;const e=(0,y.Z)(a);p=null!==(u=null==e||null===(h=e.next)||void 0===h?void 0:h.results)&&void 0!==u&&u,d.cursor=e.next.cursor}else p=!1}catch{(0,m.Iw)((0,g.t)("Error fetching releases")),p=!1}}setReleasesWithSeries(e){const{emphasizeReleases:t=[]}=this.props,s=[];if(t.length){const[r,o]=u()(e,(e=>!t.includes(e.version)));r.length&&s.push(this.getReleaseSeries(r,{type:"dotted"})),o.length&&s.push(this.getReleaseSeries(o,{opacity:.8}))}else s.push(this.getReleaseSeries(e));this.setState({releases:e,releaseSeries:s})}render(){const{children:e}=this.props;return e({releases:this.state.releases,releaseSeries:this.state.releaseSeries})}}Z.displayName="ReleaseSeries";const D=(0,a.withRouter)((0,b.Z)((0,S.Z)((0,n.b)(Z))))},"./app/components/charts/stackedAreaChart.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var r=s("../node_modules/react/index.js"),o=s("./app/components/charts/areaChart.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class n extends r.Component{render(){return(0,a.tZ)(o.Z,{tooltip:{filter:e=>e>0},...this.props,stacked:!0})}}n.displayName="StackedAreaChart";const i=n},"./app/components/discover/discoverFeature.tsx":(e,t,s)=>{s.d(t,{Z:()=>d}),s("../node_modules/react/index.js");var r=s("./app/components/acl/feature.tsx"),o=s("./app/components/acl/featureDisabled.tsx"),a=s("./app/components/hovercard.tsx"),n=s("./app/locale.tsx"),i=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function l({children:e}){const t=(0,n.t)("Requires discover feature.");return(0,i.tZ)(r.Z,{hookName:"feature-disabled:open-discover",features:["organizations:discover-basic"],renderDisabled:e=>(0,i.tZ)(a.ZP,{body:(0,i.tZ)(o.Z,{features:e.features,hideHelpToggle:!0,message:t,featureName:t}),children:e.children(e)}),children:({hasFeature:t})=>e({hasFeature:t})})}l.displayName="DiscoverFeature";const d=l},"./app/components/discoverButton.tsx":(e,t,s)=>{s.d(t,{Z:()=>i}),s("../node_modules/react/index.js");var r=s("./app/components/button.tsx"),o=s("./app/components/discover/discoverFeature.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function n({children:e,...t}){return(0,a.tZ)(o.Z,{children:({hasFeature:s})=>(0,a.tZ)(r.ZP,{disabled:!s,...t,children:e})})}n.displayName="DiscoverButton";const i=n},"./app/components/issues/groupList.tsx":(e,t,s)=>{s.d(t,{Z:()=>k});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("../node_modules/react-router/es/index.js"),n=s("../node_modules/@sentry/minimal/esm/index.js"),i=s("../node_modules/lodash/isEqual.js"),l=s.n(i),d=s("../node_modules/lodash/omit.js"),p=s.n(d),c=s("../node_modules/query-string/index.js"),u=s("./app/actionCreators/members.tsx"),m=s("./app/components/emptyStateWarning.tsx"),h=s("./app/components/loadingError.tsx"),g=s("./app/components/loadingIndicator.tsx"),v=s("./app/components/pagination.tsx"),f=s("./app/components/panels/index.tsx"),x=s("./app/components/stream/group.tsx"),y=s("./app/locale.tsx"),S=s("./app/stores/groupStore.tsx"),b=s("./app/utils/callIfFunction.tsx"),P=s("./app/utils/streamManager.tsx"),Z=s("./app/utils/withApi.tsx"),D=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),j=s("./app/styles/space.tsx"),w=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const _=({withChart:e=!0,narrowGroups:t=!1})=>(0,w.BX)(f.V9,{disablePadding:!0,children:[(0,w.tZ)(E,{children:(0,y.t)("Issue")}),e&&(0,w.tZ)(q,{className:"hidden-xs hidden-sm ".concat(t?"hidden-md":""),children:(0,y.t)("Graph")}),(0,w.tZ)(A,{children:(0,y.t)("events")}),(0,w.tZ)(A,{children:(0,y.t)("users")}),(0,w.tZ)(N,{className:"hidden-xs hidden-sm toolbar-header",children:(0,y.t)("Assignee")})]});_.displayName="GroupListHeader";const R=_,C=(0,D.Z)("div",{target:"emaz6xo4"})("display:flex;align-self:center;margin:0 ",(0,j.Z)(2),";"),E=(0,D.Z)(C,{target:"emaz6xo3"})("flex:1;width:66.66%;@media (min-width: ",(e=>e.theme.breakpoints[1]),"){width:50%;}"),A=(0,D.Z)(C,{target:"emaz6xo2"})("justify-content:flex-end;width:60px;@media (min-width: ",(e=>e.theme.breakpoints[3]),"){width:80px;}"),q=(0,D.Z)(C,{target:"emaz6xo1"})({name:"1yz45kt",styles:"justify-content:space-between;width:160px"}),N=(0,D.Z)(C,{target:"emaz6xo0"})({name:"8mimsw",styles:"justify-content:flex-end;width:80px"});class T extends o.Component{constructor(...e){super(...e),(0,r.Z)(this,"state",{loading:!0,error:!1,groups:[],pageLinks:null}),(0,r.Z)(this,"listener",S.Z.listen((()=>this.onGroupChange()),void 0)),(0,r.Z)(this,"_streamManager",new P.Z(S.Z)),(0,r.Z)(this,"fetchData",(()=>{S.Z.loadInitialData([]);const{api:e,orgId:t}=this.props;e.clear(),this.setState({loading:!0,error:!1}),(0,u.MA)(e,t).then((e=>{this.setState({memberList:(0,u.M4)(e)})}));const s=this.getGroupListEndpoint();e.request(s,{success:(e,t,s)=>{var r;this._streamManager.push(e),this.setState({error:!1,loading:!1,pageLinks:null!==(r=null==s?void 0:s.getResponseHeader("Link"))&&void 0!==r?r:null},(()=>{var e,t;null===(e=(t=this.props).onFetchSuccess)||void 0===e||e.call(t,this.state,this.handleCursorChange)}))},error:e=>{n.Tb(e),this.setState({error:!0,loading:!1})}})}))}componentDidMount(){this.fetchData()}shouldComponentUpdate(e,t){return!l()(this.state,t)||e.endpointPath!==this.props.endpointPath||e.query!==this.props.query||!l()(e.queryParams,this.props.queryParams)}componentDidUpdate(e){const t=["end"];e.orgId===this.props.orgId&&e.endpointPath===this.props.endpointPath&&e.query===this.props.query&&l()(p()(e.queryParams,t),p()(this.props.queryParams,t))||this.fetchData()}componentWillUnmount(){S.Z.reset(),(0,b.g)(this.listener)}getGroupListEndpoint(){const{orgId:e,endpointPath:t,queryParams:s}=this.props,r=null!=t?t:"/organizations/".concat(e,"/issues/"),o=null!=s?s:this.getQueryParams();return"".concat(r,"?").concat(c.stringify(o))}getQueryParams(){const{location:e,query:t}=this.props,s=e.query;return s.limit=50,s.sort="new",s.query=t,s}handleCursorChange(e,t,s,r){const o=parseInt(s.page,10);let n=isNaN(o)?r:o+r;n<=0&&(e=void 0,n=void 0),a.browserHistory.push({pathname:t,query:{...s,cursor:e,page:n}})}onGroupChange(){const e=this._streamManager.getAllItems();l()(e,this.state.groups)||this.setState({groups:e})}render(){const{canSelectGroups:e,withChart:t,renderEmptyMessage:s,withPagination:r,useFilteredStats:a,useTintRow:n,customStatsPeriod:i,queryParams:l,queryFilterDescription:d,narrowGroups:p}=this.props,{loading:c,error:u,groups:S,memberList:b,pageLinks:P}=this.state;if(c)return(0,w.tZ)(g.Z,{});if(u)return(0,w.tZ)(h.Z,{onRetry:this.fetchData});if(0===S.length)return"function"==typeof s?s():(0,w.tZ)(f.s_,{children:(0,w.tZ)(f.N,{children:(0,w.tZ)(m.Z,{children:(0,w.tZ)("p",{children:(0,y.t)("There don't seem to be any events fitting the query.")})})})});const Z="auto"===(null==l?void 0:l.groupStatsPeriod)?null==l?void 0:l.groupStatsPeriod:x.g;return(0,w.BX)(o.Fragment,{children:[(0,w.BX)(f.s_,{children:[(0,w.tZ)(R,{withChart:!!t,narrowGroups:p}),(0,w.tZ)(f.N,{children:S.map((({id:s,project:r})=>{const o=null!=b&&b.hasOwnProperty(r.slug)?b[r.slug]:void 0;return(0,w.tZ)(x.Z,{id:s,canSelect:e,withChart:t,memberList:o,useFilteredStats:a,useTintRow:n,customStatsPeriod:i,statsPeriod:Z,queryFilterDescription:d,narrowGroups:p},s)}))})]}),r&&(0,w.tZ)(v.Z,{pageLinks:P,onCursor:this.handleCursorChange})]})}}T.displayName="GroupList",(0,r.Z)(T,"defaultProps",{canSelectGroups:!0,withChart:!0,withPagination:!0,useFilteredStats:!0,useTintRow:!0,narrowGroups:!1});const k=(0,Z.Z)((0,a.withRouter)(T))},"./app/utils/getPeriod.tsx":(e,t,s)=>{s.d(t,{X:()=>i}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/moment/moment.js"),o=s.n(r),a=s("./app/constants/index.tsx"),n=s("./app/utils/dates.tsx");const i=({period:e,start:t,end:s},{shouldDoublePeriod:r}={})=>{if(e||t||s||(e=a.GY),e){if(!r)return{statsPeriod:e};const[,t,s]=e.match(/([0-9]+)([mhdw])/);return{statsPeriod:"".concat(2*parseInt(t,10)).concat(s)}}if(!t||!s)throw new Error("start and end required");const i=(0,n.v5)(t),l=(0,n.v5)(s);if(r){const e=o()(s).diff(o()(t)),r=o()(t).subtract(e);return{start:(0,n.v5)(r),end:l}}return{start:i,end:l}}},"./app/views/performance/trends/types.tsx":(e,t,s)=>{let r,o,a;s.d(t,{ER:()=>r,Z2:()=>o,A2:()=>a}),function(e){e.IMPROVED="improved",e.REGRESSION="regression"}(r||(r={})),function(e){e.P50="p50",e.P75="p75",e.P95="p95",e.P99="p99",e.AVG="avg"}(o||(o={})),function(e){e.DURATION="transaction.duration",e.LCP="measurements.lcp",e.FCP="measurements.fcp",e.FID="measurements.fid",e.CLS="measurements.cls",e.SPANS_DB="spans.db",e.SPANS_HTTP="spans.http",e.SPANS_BROWSER="spans.browser",e.SPANS_RESOURCE="spans.resource"}(a||(a={}))},"./app/views/performance/trends/utils.tsx":(e,t,s)=>{s.d(t,{_1:()=>m,bg:()=>h,T1:()=>g,cs:()=>v,es:()=>f,vt:()=>S,Ws:()=>b,CE:()=>P,IO:()=>Z,ed:()=>D,Kt:()=>j,_H:()=>w,kM:()=>_,iF:()=>R,wx:()=>C,RP:()=>E,j_:()=>A,P4:()=>q,HF:()=>T,vq:()=>k}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var r=s("../node_modules/downsample/methods/ASAP.js"),o=s("../node_modules/moment/moment.js"),a=s.n(o),n=s("./app/components/charts/utils.tsx"),i=s("./app/locale.tsx"),l=s("./app/utils/discover/fields.tsx"),d=s("./app/utils/queryString.tsx"),p=s("./app/utils/theme.tsx"),c=s("./app/utils/tokenizeSearch.tsx"),u=s("./app/views/performance/trends/types.tsx");const m="14d",h="15min",g=[{label:"p50",field:u.Z2.P50,alias:"percentile_range",legendLabel:"p50"},{label:"p75",field:u.Z2.P75,alias:"percentile_range",legendLabel:"p75"},{label:"p95",field:u.Z2.P95,alias:"percentile_range",legendLabel:"p95"},{label:"p99",field:u.Z2.P99,alias:"percentile_range",legendLabel:"p99"},{label:"average",field:u.Z2.AVG,alias:"avg_range",legendLabel:"average"}],v=[{label:"Duration",column:u.A2.DURATION},{label:"LCP",column:u.A2.LCP},{label:"FCP",column:u.A2.FCP},{label:"FID",column:u.A2.FID},{label:"CLS",column:u.A2.CLS},{label:"Spans (http)",column:u.A2.SPANS_HTTP},{label:"Spans (db)",column:u.A2.SPANS_DB},{label:"Spans (browser)",column:u.A2.SPANS_BROWSER},{label:"Spans (resource)",column:u.A2.SPANS_RESOURCE}],f={[u.ER.IMPROVED]:{lighter:p.ZP.green200,default:p.ZP.green300},[u.ER.REGRESSION]:{lighter:p.ZP.red200,default:p.ZP.red300}},x={[u.ER.IMPROVED]:"improvedSelected",[u.ER.REGRESSION]:"regressionSelected"},y={[u.ER.IMPROVED]:"improvedUnselectedSeries",[u.ER.REGRESSION]:"regressionUnselectedSeries"},S={[u.ER.IMPROVED]:"improvedCursor",[u.ER.REGRESSION]:"regressionCursor"};function b(){const e={};return Object.values(S).forEach((t=>e[t]=void 0)),e}function P(e){var t;const s=(0,d.ro)(null==e||null===(t=e.query)||void 0===t?void 0:t.trendFunction);return g.find((({field:e})=>e===s))||g[0]}function Z(e){var t;const s=(0,d.ro)(null==e||null===(t=e.query)||void 0===t?void 0:t.trendParameter);return v.find((({label:e})=>e===s))||v[0]}function D(e,t){return(0,l.sN)({kind:"function",function:[e,t,void 0,void 0]})}function j(e,t){return{fromSeconds:e/1e3,toSeconds:t/1e3,showDigits:e>1e3||t>1e3||e<10||t<10}}function w(e,t){if(!e.project||!t)return;const s=t.find((t=>t.slug===e.project));return null==s?void 0:s.id}function _(e,t,s,r){const o=P(t),a=Z(t),i=[...r?[]:["transaction"],"project"].map((e=>({field:e}))),l={field:"trend_percentage()",kind:"asc"};e.trendType=s,s===u.ER.REGRESSION&&(l.kind="desc"),o&&a&&(e.trendFunction=D(o.field,a.column)),e.query=function(e){const t=new c.MY(e);return t.hasFilter("count_percentage()")||t.addFilterValues("count_percentage()",[">0.25","<4"]),t.hasFilter("trend_percentage()")||t.addFilterValues("trend_percentage()",[">0%"]),t.hasFilter("confidence()")||t.addFilterValues("confidence()",[">6"]),t.formatString()}(e.query),e.interval=function(e,t){var s;const r=(0,d.ro)(null==e||null===(s=e.query)||void 0===s?void 0:s.interval),{start:o,end:a,statsPeriod:i}=t,l={start:o||null,end:a||null,period:i},p=(0,n.ZS)(l,"high");return r||p}(t,e),e.sorts=[l],e.fields=i}function R(e,t){const{query:s}=t,r=s.start&&s.end;return s.statsPeriod||r||(e.statsPeriod=m),e}function C(e,t){const s=Math.abs(e);return{seconds:s/1e3,fixedDigits:s>1e3||s<10?1:0,changeLabel:t===u.ER.REGRESSION?(0,i.t)("slower"):(0,i.t)("faster")}}function E(e){const t=a()();return e.map((e=>({...e,received_at:t,transaction:e.transaction})))}function A(e){return x[e]}function q(e){return y[e]}const N=(e,t=100)=>(0,r.Cl)(e,t),T=e=>["p50","p75"].find((t=>e.includes(t)));function k(e,t){let s=Number.MAX_SAFE_INTEGER,r=0;if(!e)return{maxValue:r,minValue:s,smoothedResults:void 0};const o=[];for(const a of e){const e=a.data,n=[],i=N(e.map((({name:e,value:t})=>[Number(e),t])));for(let e=0;e<i.length;e++){const t=i[e],o=t.y;if(n.push({name:t.x,value:o}),!isNaN(o)){const e=Math.round(o);s=Math.min(e,s),r=Math.max(e,r)}}o.push({seriesName:t||a.seriesName||"Current",data:n,lineStyle:a.lineStyle,color:a.color})}return{minValue:s,maxValue:r,smoothedResults:o}}}}]);
//# sourceMappingURL=../sourcemaps/app_components_charts_eventsChart_tsx-app_components_charts_stackedAreaChart_tsx-app_componen-fd742c.c813ee51fc5ea1ab3f3cc25ab93b4258.js.map