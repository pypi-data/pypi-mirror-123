(self.webpackChunk=self.webpackChunk||[]).push([["app_components_banner_tsx-app_components_charts_areaChart_tsx-app_components_charts_eventsReq-f3717c","app_components_sentryDocumentTitle_tsx"],{"./app/actionCreators/discoverSavedQueries.tsx":(e,t,s)=>{"use strict";s.d(t,{Yi:()=>n,GH:()=>i,M6:()=>d,EQ:()=>c,qF:()=>u}),s("../node_modules/core-js/modules/es.string.trim.js");var a=s("./app/actionCreators/indicator.tsx"),r=s("./app/api.tsx"),o=s("./app/locale.tsx");function n(e,t,s){const r=e.requestPromise("/organizations/".concat(t,"/discover/saved/").concat(s,"/"),{method:"GET"});return r.catch((()=>{(0,a.Iw)((0,o.t)("Unable to load saved query"))})),r}function i(e,t,s){const r=e.requestPromise("/organizations/".concat(t,"/discover/saved/"),{method:"POST",data:s});return r.catch((()=>{(0,a.Iw)((0,o.t)("Unable to create your saved query"))})),r}function d(e,t,s){const r=e.requestPromise("/organizations/".concat(t,"/discover/saved/").concat(s.id,"/"),{method:"PUT",data:s});return r.catch((()=>{(0,a.Iw)((0,o.t)("Unable to update your saved query"))})),r}function c(e,t){return(new r.KU).requestPromise("/organizations/".concat(e,"/discover/saved/").concat(t,"/visit/"),{method:"POST"})}function u(e,t,s){const r=e.requestPromise("/organizations/".concat(t,"/discover/saved/").concat(s,"/"),{method:"DELETE"});return r.catch((()=>{(0,a.Iw)((0,o.t)("Unable to delete the saved query"))})),r}},"./app/actionCreators/events.tsx":(e,t,s)=>{"use strict";s.d(t,{lI:()=>d,eV:()=>c,JE:()=>u}),s("../node_modules/core-js/modules/es.object.from-entries.js"),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=s("../node_modules/lodash/pick.js"),r=s.n(a),o=s("./app/components/charts/utils.tsx"),n=s("./app/utils/getPeriod.tsx"),i=s("./app/utils/performance/constants.tsx");const d=(e,{organization:t,project:s,environment:a,team:r,period:i,start:d,end:c,interval:u,comparisonDelta:l,includePrevious:m,query:p,yAxis:v,field:h,topEvents:g,orderby:y,partial:f,withoutZerofill:_,referrer:q})=>{const x=(0,o.Sw)(m,i),D=Object.fromEntries(Object.entries({interval:u,comparisonDelta:l,project:s,environment:a,team:r,query:p,yAxis:v,field:h,topEvents:g,orderby:y,partial:f?"1":void 0,withoutZerofill:_?"1":void 0,referrer:q||"api.organization-event-stats"}).filter((([,e])=>void 0!==e))),b=(0,n.X)({period:i,start:d,end:c},{shouldDoublePeriod:x});return e.requestPromise("/organizations/".concat(t.slug,"/events-stats/"),{query:{...D,...b}})};async function c(e,t,s){const a={...r()(s,Object.values(i.s)),query:s.query};return e.requestPromise("/organizations/".concat(t,"/events-facets/"),{query:a})}async function u(e,t,s){const a={...r()(s,Object.values(i.s)),query:s.query};return e.requestPromise("/organizations/".concat(t,"/events-meta/"),{query:a}).then((e=>e.count))}},"./app/components/banner.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>x});var a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),o=s("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),n=s("./app/components/button.tsx"),i=s("./app/components/buttonBar.tsx"),d=s("./app/icons/index.tsx"),c=s("./app/locale.tsx"),u=s("./app/styles/space.tsx"),l=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const m=e=>"".concat(e,"-banner-dismissed");function p(e){localStorage.setItem(m(e),"true")}const v=({title:e,subtitle:t,isDismissable:s=!0,dismissKey:a="generic-banner",className:o,backgroundImg:n,backgroundComponent:i,children:d})=>{const[u,v]=function(e){const t=m(e),[s,a]=r.useState(localStorage.getItem(t));return["true"===s,()=>{a("true"),p(e)}]}(a);return u?null:(0,l.BX)(h,{backgroundImg:n,className:o,children:[i,s?(0,l.tZ)(q,{onClick:v,"aria-label":(0,c.t)("Close")}):null,(0,l.BX)(g,{children:[(0,l.tZ)(y,{children:e}),(0,l.tZ)(f,{children:t}),(0,l.tZ)(_,{gap:1,children:d})]})]})};v.displayName="Banner",v.dismiss=p;const h=(0,a.Z)("div",{target:"e8az5815"})((e=>e.backgroundImg?(0,o.iv)("background:url(",e.backgroundImg,");background-repeat:no-repeat;background-size:cover;background-position:center center;",""):(0,o.iv)("background-color:",e.theme.gray500,";",""))," display:flex;overflow:hidden;align-items:center;justify-content:center;position:relative;margin-bottom:",(0,u.Z)(2),";box-shadow:",(e=>e.theme.dropShadowLight),";border-radius:",(e=>e.theme.borderRadius),";height:180px;color:",(e=>e.theme.white),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){height:220px;}"),g=(0,a.Z)("div",{target:"e8az5814"})("position:absolute;display:grid;justify-items:center;grid-template-rows:repeat(3, max-content);text-align:center;padding:",(0,u.Z)(4),";"),y=(0,a.Z)("h1",{target:"e8az5813"})("margin:0;@media (min-width: ",(e=>e.theme.breakpoints[0]),"){font-size:40px;}"),f=(0,a.Z)("div",{target:"e8az5812"})("margin:0;@media (min-width: ",(e=>e.theme.breakpoints[0]),"){font-size:",(e=>e.theme.fontSizeExtraLarge),";}"),_=(0,a.Z)(i.ZP,{target:"e8az5811"})("margin-top:",(0,u.Z)(2),";width:fit-content;"),q=(0,a.Z)(n.ZP,{target:"e8az5810"})("position:absolute;display:block;top:",(0,u.Z)(2),";right:",(0,u.Z)(2),";color:",(e=>e.theme.white),";cursor:pointer;z-index:1;");q.defaultProps={icon:(0,l.tZ)(d.bM,{}),label:(0,c.t)("Close"),priority:"link",borderless:!0,size:"xsmall"};const x=v},"./app/components/charts/areaChart.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var a=s("../node_modules/react/index.js"),r=s("./app/components/charts/series/lineSeries.tsx"),o=s("./app/components/charts/baseChart.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends a.Component{render(){const{series:e,stacked:t,colors:s,...a}=this.props;return(0,n.tZ)(o.Z,{...a,colors:s,series:e.map((({seriesName:e,data:a,...o},n)=>function(e={}){return(0,r.Z)({...e})}({stack:t?"area":void 0,name:e,data:a.map((({name:e,value:t})=>[e,t])),lineStyle:{color:null==s?void 0:s[n],opacity:1,width:.4},areaStyle:{color:null==s?void 0:s[n],opacity:1},animation:!1,animationThreshold:1,animationDuration:0,...o})))})}}i.displayName="AreaChart";const d=i},"./app/components/charts/eventsRequest.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>_});var a=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),o=s("../node_modules/lodash/isEqual.js"),n=s.n(o),i=s("../node_modules/lodash/omitBy.js"),d=s.n(i),c=s("./app/actionCreators/events.tsx"),u=s("./app/actionCreators/indicator.tsx"),l=s("./app/components/charts/loadingPanel.tsx"),m=s("./app/components/charts/utils.tsx"),p=s("./app/locale.tsx"),v=s("./app/utils/discover/fields.tsx"),h=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const g=["api","children","organization","loading"],y=e=>d()(e,((e,t)=>g.includes(t)));class f extends r.PureComponent{constructor(...e){super(...e),(0,a.Z)(this,"state",{reloading:!!this.props.loading,errored:!1,timeseriesData:null,fetchedWithPrevious:!1}),(0,a.Z)(this,"unmounting",!1),(0,a.Z)(this,"fetchData",(async()=>{const{api:e,confirmedQuery:t,expired:s,name:a,hideError:r,...o}=this.props;let n=null;if(!1!==t){if(this.setState((e=>({reloading:null!==e.timeseriesData,errored:!1}))),s)(0,u.Iw)((0,p.t)("%s has an invalid date range. Please try a more recent date range.",a),{append:!0}),this.setState({errored:!0});else try{e.clear(),n=await(0,c.lI)(e,o)}catch(e){r||(e&&e.responseJSON&&e.responseJSON.detail?(0,u.Iw)(e.responseJSON.detail):(0,u.Iw)((0,p.t)("Error loading chart data"))),this.setState({errored:!0})}this.unmounting||this.setState({reloading:!1,timeseriesData:n,fetchedWithPrevious:o.includePrevious})}})),(0,a.Z)(this,"getData",(e=>{const{fetchedWithPrevious:t}=this.state,{period:s,includePrevious:a}=this.props,r=t||(0,m.Sw)(a,s),o=Math.floor(e.length/2);return{current:r?e.slice(o):e,previous:r?e.slice(0,o):null}}))}componentDidMount(){this.fetchData()}componentDidUpdate(e){n()(y(e),y(this.props))||this.fetchData()}componentWillUnmount(){this.unmounting=!0}calculateTotalsPerTimestamp(e,t=(e=>1e3*e)){return e.map((([e,s],a)=>({name:t(e,s,a),value:s.reduce(((e,{count:t})=>e+t),0)})))}transformPreviousPeriodData(e,t,s){return t?{seriesName:null!=s?s:"Previous",data:this.calculateTotalsPerTimestamp(t,((t,s,a)=>1e3*e[a][0])),stack:"previous"}:null}transformAggregatedTimeseries(e,t=""){return{seriesName:t,data:this.calculateTotalsPerTimestamp(e)}}transformTimeseriesData(e,t){return[{seriesName:t||"Current",data:e.map((([e,t])=>({name:1e3*e,value:t.reduce(((e,{count:t})=>e+t),0)})))}]}transformComparisonTimeseriesData(e){return[{seriesName:"comparisonCount()",data:e.map((([e,t])=>({name:1e3*e,value:t.reduce(((e,{comparisonCount:t})=>e+(null!=t?t:0)),0)})))}]}processData(e,t=0,s){var a;const{data:r,totals:o}=e,{includeTransformedData:n,includeTimeAggregation:i,timeAggregationSeriesName:d,currentSeriesNames:c,previousSeriesNames:u,comparisonDelta:l}=this.props,{current:m,previous:p}=this.getData(r);return{data:n?this.transformTimeseriesData(m,null!=s?s:null==c?void 0:c[t]):[],comparisonData:n&&l?this.transformComparisonTimeseriesData(m):[],allData:r,originalData:m,totals:o,originalPreviousData:p,previousData:n?this.transformPreviousPeriodData(m,p,null!==(a=s?"previous ".concat(s):void 0)&&void 0!==a?a:null==u?void 0:u[t]):null,timeAggregatedData:i?this.transformAggregatedTimeseries(m,d||""):{},timeframe:e.start&&e.end?p?{start:500*(e.start+e.end),end:1e3*e.end}:{start:1e3*e.start,end:1e3*e.end}:void 0}}render(){const{children:e,showLoading:t,...s}=this.props,{timeseriesData:a,reloading:r,errored:o}=this.state,n=this.props.loading||null===a;if(t&&n)return(0,h.tZ)(l.Z,{"data-test-id":"events-request-loading"});if((0,m.Xe)(a)){let t;const i=Object.keys(a).map(((e,s)=>{const r=a[e],o=this.processData(r,s,(0,v.bQ)(e));return t||(t=o.timeframe),[r.order||0,o.data[0],o.previousData]})).sort(((e,t)=>e[0]-t[0])),d=i.map((e=>e[1])),c=i.some((e=>null===e[2]))?void 0:i.map((e=>e[2]));return e({loading:n,reloading:r,errored:o,results:d,timeframe:t,previousTimeseriesData:c,...s})}if(a){const{data:t,comparisonData:i,allData:d,originalData:c,totals:u,originalPreviousData:l,previousData:m,timeAggregatedData:p,timeframe:v}=this.processData(a);return e({loading:n,reloading:r,errored:o,timeseriesData:t,comparisonTimeseriesData:i,allTimeseriesData:d,originalTimeseriesData:c,timeseriesTotals:u,originalPreviousTimeseriesData:l,previousTimeseriesData:m?[m]:m,timeAggregatedData:p,timeframe:v,...s})}return e({loading:n,reloading:r,errored:o,...s})}}f.displayName="EventsRequest",(0,a.Z)(f,"defaultProps",{period:void 0,start:null,end:null,interval:"1d",comparisonDelta:void 0,limit:15,query:"",includePrevious:!0,includeTransformedData:!0});const _=f},"./app/components/sentryDocumentTitle.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>i}),s("../node_modules/react/index.js");var a=s("../node_modules/react-document-title/index.js"),r=s.n(a),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function n({title:e,orgSlug:t,projectSlug:s,children:a}){const n=t||s?t&&s?"".concat(e," - ").concat(t," - ").concat(s):t?"".concat(e," - ").concat(t):"".concat(e," - ").concat(s):e;return(0,o.tZ)(r(),{title:"".concat(n," - Sentry"),children:a})}n.displayName="SentryDocumentTitle";const i=n},"./app/utils/getPeriod.tsx":(e,t,s)=>{"use strict";s.d(t,{X:()=>i}),s("../node_modules/core-js/modules/web.dom-collections.iterator.js");var a=s("../node_modules/moment/moment.js"),r=s.n(a),o=s("./app/constants/index.tsx"),n=s("./app/utils/dates.tsx");const i=({period:e,start:t,end:s},{shouldDoublePeriod:a}={})=>{if(e||t||s||(e=o.GY),e){if(!a)return{statsPeriod:e};const[,t,s]=e.match(/([0-9]+)([mhdw])/);return{statsPeriod:"".concat(2*parseInt(t,10)).concat(s)}}if(!t||!s)throw new Error("start and end required");const i=(0,n.v5)(t),d=(0,n.v5)(s);if(a){const e=r()(s).diff(r()(t)),a=r()(t).subtract(e);return{start:(0,n.v5)(a),end:d}}return{start:i,end:d}}},"./app/views/eventsV2/savedQuery/utils.tsx":(e,t,s)=>{"use strict";s.d(t,{b2:()=>i,O$:()=>u,pb:()=>l,Uc:()=>m});var a=s("./app/actionCreators/discoverSavedQueries.tsx"),r=s("./app/actionCreators/indicator.tsx"),o=s("./app/locale.tsx"),n=s("./app/utils/analytics.tsx");function i(e,t,s,i,d=!0){const c=s.toNewQuery();c.yAxis=i,(0,n.ec)({...p(d,"request"),organization_id:parseInt(t.id,10),...v(c)});const u=(0,a.GH)(e,t.slug,c);return u.then((e=>((0,r.S9)((0,o.t)("Query saved")),(0,n.ec)({...p(d,"success"),organization_id:parseInt(t.id,10),...v(c)}),e))).catch((e=>{(0,r.Iw)((0,o.t)("Query not saved")),(0,n.ec)({...p(d,"failed"),organization_id:parseInt(t.id,10),...v(c),error:e&&e.message||"Could not save a ".concat(d?"new":"existing"," query")})})),u}const d={request:"Discoverv2: Request to save a saved query as a new query",success:"Discoverv2: Successfully saved a saved query as a new query",failed:"Discoverv2: Failed to save a saved query as a new query"},c={request:"Discoverv2: Request to save a new query",success:"Discoverv2: Successfully saved a new query",failed:"Discoverv2: Failed to save a new query"};function u(e,t,s,i){const d=s.toNewQuery();if(d.yAxis=i,!s.name)return(0,r.Iw)((0,o.t)("Please name your query")),Promise.reject();(0,n.ec)({eventKey:"discover_v2.update_query_request",eventName:"Discoverv2: Request to update a saved query",organization_id:parseInt(t.id,10),...v(d)});const c=(0,a.M6)(e,t.slug,d);return c.then((e=>((0,r.S9)((0,o.t)("Query updated")),(0,n.ec)({eventKey:"discover_v2.update_query_success",eventName:"Discoverv2: Successfully updated a saved query",organization_id:parseInt(t.id,10),...v(d)}),e))).catch((e=>{(0,r.Iw)((0,o.t)("Query not updated")),(0,n.ec)({eventKey:"discover_v2.update_query_failed",eventName:"Discoverv2: Failed to update a saved query",organization_id:parseInt(t.id,10),...v(d),error:e&&e.message||"Failed to update a query"})})),c}function l(e,t,s){const i=s.toNewQuery();(0,n.ec)({eventKey:"discover_v2.update_query_name_request",eventName:"Discoverv2: Request to update a saved query's name",organization_id:parseInt(t.id,10),...v(i)});const d=(0,a.M6)(e,t.slug,i);return d.then((e=>{(0,r.S9)((0,o.t)("Query name saved")),(0,n.ec)({eventKey:"discover_v2.update_query_name_success",eventName:"Discoverv2: Successfully updated a saved query's name",organization_id:parseInt(t.id,10),...v(i)})})).catch((e=>{(0,r.Iw)((0,o.t)("Query name not saved")),(0,n.ec)({eventKey:"discover_v2.update_query_failed",eventName:"Discoverv2: Failed to update a saved query's name",organization_id:parseInt(t.id,10),...v(i),error:e&&e.message||"Failed to update a query name"})})),d}function m(e,t,s){(0,n.ec)({eventKey:"discover_v2.delete_query_request",eventName:"Discoverv2: Request to delete a saved query",organization_id:parseInt(t.id,10),...v(s.toNewQuery())});const i=(0,a.qF)(e,t.slug,s.id);return i.then((()=>{(0,r.S9)((0,o.t)("Query deleted")),(0,n.ec)({eventKey:"discover_v2.delete_query_success",eventName:"Discoverv2: Successfully deleted a saved query",organization_id:parseInt(t.id,10),...v(s.toNewQuery())})})).catch((e=>{(0,r.Iw)((0,o.t)("Query not deleted")),(0,n.ec)({eventKey:"discover_v2.delete_query_failed",eventName:"Discoverv2: Failed to delete a saved query",organization_id:parseInt(t.id,10),...v(s.toNewQuery()),error:e&&e.message||"Failed to delete query"})})),i}function p(e,t){return{eventKey:e?"discover_v2.save_new_query_"+t:"discover_v2.save_existing_query_"+t,eventName:e?c[t]:d[t]}}function v(e){const{projects:t,fields:s,query:a}=e;return{projects:t,fields:s,query:a}}},"../node_modules/lodash/negate.js":e=>{e.exports=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},"../node_modules/lodash/omitBy.js":(e,t,s)=>{var a=s("../node_modules/lodash/_baseIteratee.js"),r=s("../node_modules/lodash/negate.js"),o=s("../node_modules/lodash/pickBy.js");e.exports=function(e,t){return o(e,r(a(t)))}}}]);
//# sourceMappingURL=../sourcemaps/app_components_banner_tsx-app_components_charts_areaChart_tsx-app_components_charts_eventsReq-f3717c.09c2d22352107cab22b90238d58e7669.js.map