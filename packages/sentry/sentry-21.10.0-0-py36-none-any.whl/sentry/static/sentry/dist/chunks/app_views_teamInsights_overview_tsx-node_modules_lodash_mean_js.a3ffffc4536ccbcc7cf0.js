(self.webpackChunk=self.webpackChunk||[]).push([["app_views_teamInsights_overview_tsx-node_modules_lodash_mean_js"],{"./app/components/pageTimeRangeSelector.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/react/index.js")),o=r("./app/components/organizations/timeRangeSelector/index.tsx"),i=r("./app/components/panels/index.tsx"),a=r("./app/constants/index.tsx"),d=r("./app/locale.tsx"),l=r("./app/styles/space.tsx"),c=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function u({className:e,...t}){const[r,s]=(0,n.useState)(!1);return(0,c.tZ)(m,{className:e,isCalendarOpen:r,children:(0,c.tZ)(o.Z,{label:(0,c.tZ)(p,{children:(0,d.t)("Date Range:")}),onToggleSelector:e=>s(e),relativeOptions:a.wh,...t},"period:".concat(t.relative,"-start:").concat(t.start,"-end:").concat(t.end,"-utc:").concat(t.utc,"-defaultPeriod:").concat(t.defaultPeriod))})}u.displayName="PageTimeRangeSelector";const m=(0,s.Z)(i.s_,{target:"e1hsuxgy1"})("display:flex;justify-content:center;align-items:center;height:42px;background:",(e=>e.theme.background),";border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.isCalendarOpen?"".concat(e.theme.borderRadius," ").concat(e.theme.borderRadius," 0 0"):e.theme.borderRadius),";padding:0;margin:0;font-size:",(e=>e.theme.fontSizeMedium),";color:",(e=>e.theme.textColor),";>div{width:100%;align-self:stretch;}>div>div:first-child{padding:0 ",(0,l.Z)(2),";}>div>div:last-child{box-sizing:content-box;font-size:1em;}"),p=(0,s.Z)("span",{target:"e1hsuxgy0"})("text-align:left;font-weight:600;color:",(e=>e.theme.textColor),";>span:last-child{font-weight:400;}"),g=u},"./app/utils/discover/discoverQuery.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>d}),r("../node_modules/react/index.js");var s=r("./app/utils/withApi.tsx"),n=r("./app/utils/discover/genericDiscoverQuery.tsx"),o=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e,t){return e.transactionName!==t.transactionName||e.transactionThreshold!==t.transactionThreshold||e.transactionThresholdMetric!==t.transactionThresholdMetric}function a(e){return(0,o.tZ)(n.ZP,{route:"eventsv2",shouldRefetchData:i,...e})}a.displayName="DiscoverQuery";const d=(0,s.Z)(a)},"./app/utils/withTeamsForUser.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/react/index.js")),o=r("./app/stores/configStore.tsx"),i=r("./app/utils/getDisplayName.tsx"),a=r("./app/utils/analytics.tsx"),d=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const l=e=>{var t,r;return r=t=class extends n.Component{constructor(...e){super(...e),(0,s.Z)(this,"state",{teams:[],loadingTeams:!0,error:null})}componentDidMount(){this.fetchTeams()}async fetchTeams(){this.setState({loadingTeams:!0});try{a.oF.mark({name:"user-teams-fetch-start"});const e=await this.props.api.requestPromise(this.getUsersTeamsEndpoint());this.setState({teams:e,loadingTeams:!1},(()=>{a.oF.measure({name:"app.component.perf",start:"user-teams-fetch-start",data:{name:"user-teams",route:"/organizations/:orgid/user-teams",organization_id:parseInt(this.props.organization.id,10)}})}))}catch(e){this.setState({error:e,loadingTeams:!1})}}populateTeamsWithProjects(e,t){const{isSuperuser:r}=o.Z.get("user"),{projectsByTeam:s}=function(e,t,r=!1){const s={},n=[];let o=new Set(e.filter((e=>e.isMember)).map((e=>e.slug)));return 0===o.size&&r&&(o=new Set(e.map((e=>e.slug)))),t.forEach((e=>{!e.teams.length&&e.isMember?n.push(e):e.teams.forEach((t=>{o.has(t.slug)&&(s.hasOwnProperty(t.slug)||(s[t.slug]=[]),s[t.slug].push(e))}))})),{projectsByTeam:s,teamlessProjects:n}}(e,t,r),n=e.map((e=>{const t=s[e.slug]||[];return{...e,projects:t}}));this.setState({teams:n,loadingTeams:!1})}getUsersTeamsEndpoint(){return"/organizations/".concat(this.props.organization.slug,"/user-teams/")}render(){return(0,d.tZ)(e,{...this.props,...this.state})}},(0,s.Z)(t,"displayName","withUsersTeams(".concat((0,i.Z)(e),")")),r}},"./app/views/teamInsights/headerTabs.tsx":(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r("./app/components/featureBadge.tsx"),n=r("./app/components/layouts/thirds.tsx"),o=r("./app/components/links/link.tsx"),i=r("./app/locale.tsx"),a=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d({organization:e,activeTab:t}){return(0,a.BX)(n.mL,{underlined:!0,children:[(0,a.tZ)("li",{className:"".concat("projects"===t?"active":""),children:(0,a.tZ)(o.Z,{to:"/organizations/".concat(e.slug,"/projects/"),children:(0,i.t)("Overview")})}),(0,a.tZ)("li",{className:"".concat("teamInsights"===t?"active":""),children:(0,a.BX)(o.Z,{to:"/organizations/".concat(e.slug,"/teamInsights/"),children:[(0,i.t)("Reports"),(0,a.tZ)(s.Z,{type:"alpha"})]})})]})}d.displayName="HeaderTabs";const l=d},"./app/views/teamInsights/overview.tsx":(e,t,r)=>{"use strict";r.r(t),r.d(t,{TeamInsightsOverview:()=>Ye,default:()=>$e});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=r("../node_modules/react/index.js"),o=r("../node_modules/@emotion/react/dist/emotion-element-a8309070.browser.esm.js"),i=r("../node_modules/lodash/pick.js"),a=r.n(i),d=r("../node_modules/moment/moment.js"),l=r.n(d),c=r("./app/components/forms/teamSelector.tsx"),u=r("./app/components/layouts/thirds.tsx"),m=r("./app/components/loadingIndicator.tsx"),p=r("./app/components/organizations/globalSelectionHeader/getParams.tsx"),g=r("./app/components/pageTimeRangeSelector.tsx"),h=r("./app/locale.tsx"),Z=r("./app/styles/space.tsx"),v=r("./app/utils/localStorage.tsx"),x=r("./app/utils/withApi.tsx"),f=r("./app/utils/withOrganization.tsx"),y=r("./app/utils/withTeamsForUser.tsx"),b=(r("../node_modules/core-js/modules/es.symbol.description.js"),r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js"));function w({title:e,description:t,children:r}){return(0,b.BX)(S,{children:[(0,b.BX)(T,{children:[(0,b.tZ)(k,{children:e}),(0,b.tZ)(z,{children:t})]}),(0,b.tZ)(_,{children:r})]})}w.displayName="DescriptionCard";const j=w,S=(0,s.Z)("div",{target:"e1ecsa2r4"})("border:1px solid ",(e=>e.theme.border),";border-radius:",(e=>e.theme.borderRadius),";display:flex;margin-bottom:",(0,Z.Z)(3),";flex-direction:column;@media (min-width: ",(e=>e.theme.breakpoints[1]),"){flex-direction:row;}"),T=(0,s.Z)("div",{target:"e1ecsa2r3"})("padding:",(0,Z.Z)(2)," ",(0,Z.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";@media (min-width: ",(e=>e.theme.breakpoints[1]),"){max-width:250px;border-right:1px solid ",(e=>e.theme.border),";border-bottom:0;}"),k=(0,s.Z)("div",{target:"e1ecsa2r2"})("font-size:",(e=>e.theme.fontSizeLarge),";margin:0 0 ",(0,Z.Z)(.5),";"),z=(0,s.Z)("div",{target:"e1ecsa2r1"})("color:",(e=>e.theme.subText),";"),_=(0,s.Z)("div",{target:"e1ecsa2r0"})({name:"1ff36h2",styles:"flex-grow:1"});var B=r("./app/views/teamInsights/headerTabs.tsx"),R=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),D=(r("../node_modules/core-js/modules/web.dom-collections.iterator.js"),r("../node_modules/core-js/modules/es.array.reverse.js"),r("./app/components/asyncComponent.tsx")),N=r("./app/components/charts/barChart.tsx"),C=r("../node_modules/lodash/chunk.js"),M=r.n(C);function P(e){const t=e.sort(((e,t)=>new Date(e.name).getTime()-new Date(t.name).getTime()));return M()(t,7).map((e=>({name:e[0].name,value:e.reduce(((e,t)=>e+t.value),0)})))}function L(e){return Object.entries(e).map((([e,t])=>({value:t,name:new Date(e).getTime()})))}class q extends D.Z{constructor(...e){super(...e),(0,R.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),alertsTriggered:null}}getEndpoints(){const{organization:e,start:t,end:r,period:s,utc:n,teamSlug:o}=this.props,i={start:t,end:r,period:s,utc:n};return[["alertsTriggered","/teams/".concat(e.slug,"/").concat(o,"/alerts-triggered/"),{query:{...(0,p.Q)(i)}}]]}componentDidUpdate(e){const{start:t,end:r,period:s,utc:n,teamSlug:o}=this.props;e.start===t&&e.end===r&&e.period===s&&e.utc===n&&e.teamSlug===o||this.remountComponent()}renderLoading(){return(0,b.tZ)(X,{children:(0,b.tZ)(m.Z,{})})}renderBody(){const{alertsTriggered:e}=this.state,t=P(L(null!=e?e:{}));return(0,b.tZ)(X,{children:e&&(0,b.tZ)(N.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:0,top:0},yAxis:{minInterval:1},xAxis:{type:"time"},series:[{seriesName:(0,h.t)("Alerts Triggered"),data:t}].reverse()})})}}const I=q,X=(0,s.Z)("div",{target:"e11d2vud0"})("padding:",(0,Z.Z)(2)," ",(0,Z.Z)(2)," 0 ",(0,Z.Z)(2),";");var E=r("../node_modules/lodash/isEqual.js"),A=r.n(E),F=r("./app/components/idBadge/index.tsx"),O=r("./app/components/panels/panelTable.tsx"),U=r("./app/components/placeholder.tsx"),Q=r("./app/utils/formatters.tsx");class W extends D.Z{constructor(...e){super(...e),(0,R.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),issuesBreakdown:null}}getEndpoints(){const{organization:e,start:t,end:r,period:s,utc:n,teamSlug:o}=this.props,i={start:t,end:r,period:s,utc:n};return[["issuesBreakdown","/teams/".concat(e.slug,"/").concat(o,"/issue-breakdown/"),{query:{...(0,p.Q)(i)}}]]}componentDidUpdate(e){const{start:t,end:r,period:s,utc:n,teamSlug:o,projects:i}=this.props;e.start===t&&e.end===r&&e.period===s&&e.utc===n&&e.teamSlug===o&&A()(e.projects,i)||this.remountComponent()}renderLoading(){return this.renderBody()}renderBody(){const{issuesBreakdown:e,loading:t}=this.state,{projects:r}=this.props,s={},o={},i={};if(e)for(const[t,r]of Object.entries(e))for(const[e,{reviewed:n,total:a}]of Object.entries(r)){i[t]||(i[t]={reviewed:0,total:0}),i[t].reviewed+=n,i[t].total+=a,void 0===s[e]?s[e]=n:s[e]+=n;const r=a-n;void 0===o[e]?o[e]=r:o[e]+=r}const a=L(s),d=L(o);return(0,b.BX)(n.Fragment,{children:[(0,b.BX)(H,{children:[t&&(0,b.tZ)(U.Z,{height:"200px"}),!t&&(0,b.tZ)(N.Z,{style:{height:200},stacked:!0,isGroupedByDate:!0,legend:{right:0,top:0},series:[{seriesName:(0,h.t)("Reviewed"),data:P(a)},{seriesName:(0,h.t)("Not Reviewed"),data:P(d)}]})]}),(0,b.tZ)(J,{headers:[(0,h.t)("Project"),(0,b.tZ)($,{children:(0,h.t)("For Review")},"forReview"),(0,b.tZ)($,{children:(0,h.t)("Reviewed")},"reviewed"),(0,b.tZ)($,{children:(0,h.t)("% Reviewed")},"change")],isLoading:t,children:r.map((e=>{var t;const{total:r,reviewed:s}=null!==(t=i[e.id])&&void 0!==t?t:{};return(0,b.BX)(n.Fragment,{children:[(0,b.tZ)(K,{children:(0,b.tZ)(Y,{avatarSize:18,project:e})}),(0,b.tZ)($,{children:r}),(0,b.tZ)($,{children:s}),(0,b.tZ)($,{children:0===r?"—":(0,Q.rl)(s/r)})]},e.id)}))})]})}}const G=W,V=(0,s.Z)("div",{target:"e1gl5x4e5"})("padding:",(0,Z.Z)(2)," ",(0,Z.Z)(2)," 0 ",(0,Z.Z)(2),";"),H=(0,s.Z)(V,{target:"e1gl5x4e4"})("border-bottom:1px solid ",(e=>e.theme.border),";"),J=(0,s.Z)(O.Z,{target:"e1gl5x4e3"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,Z.Z)(1)," ",(0,Z.Z)(2),";}"),K=(0,s.Z)("div",{target:"e1gl5x4e2"})({name:"zjik7",styles:"display:flex"}),Y=(0,s.Z)(F.Z,{target:"e1gl5x4e1"})({name:"ozd7xs",styles:"flex-shrink:0"}),$=(0,s.Z)("div",{target:"e1gl5x4e0"})({name:"mnwtso",styles:"text-align:right;font-variant-numeric:tabular-nums"});var ee=r("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),te=r("./app/components/links/link.tsx"),re=r("./app/icons/index.tsx"),se=r("./app/styles/overflowEllipsis.tsx"),ne=r("./app/utils/discover/discoverQuery.tsx"),oe=r("./app/utils/discover/eventView.tsx"),ie=r("./app/utils/discover/fieldRenderers.tsx"),ae=r("./app/views/performance/transactionSummary/utils.tsx");function de({organization:e,location:t,projects:r,periodTableData:s,weekTableData:o,isLoading:i,period:a}){var d;const[l,c]=(0,n.useState)(!1),u=(null==s?void 0:s.meta)&&(0,ie.Js)("user_misery",s.meta),m=(null!==(d=null==s?void 0:s.data)&&void 0!==d?d:[]).map((e=>{const t=null==o?void 0:o.data.find((t=>t.project===e.project&&t.transaction===e.transaction)),r=t?100*(e.user_misery-t.user_misery):null;return{...e,trend:r}})).filter((e=>null!==e.trend)).sort(((e,t)=>Math.abs(t.trend)-Math.abs(e.trend))),p=[...m.filter((e=>Math.round(e.trend)<0)),...m.filter((e=>Math.round(e.trend)>0)),...m.filter((e=>0===Math.round(e.trend)))];return(0,b.BX)(n.Fragment,{children:[(0,b.tZ)(ue,{isEmpty:0===r.length||0===(null==s?void 0:s.data.length),headers:[(0,h.t)("Key transaction"),(0,h.t)("Project"),(0,h._N)("Last [period]",{period:a}),(0,h.t)("This Week"),(0,b.tZ)(he,{children:(0,h.t)("Change")},"change")],isLoading:i,children:p.map(((s,i)=>{const a=r.find((({slug:e})=>s.project===e)),{trend:d,project:c,transaction:m}=s,p=null==o?void 0:o.data.find((e=>e.project===c&&e.transaction===m));if(!p||null===d)return null;const g=null==u?void 0:u(s,{organization:e,location:t}),Z=p&&(null==u?void 0:u(p,{organization:e,location:t})),v=Math.round(Math.abs(d));return i>=8&&!l?null:(0,b.BX)(n.Fragment,{children:[(0,b.tZ)(ge,{children:(0,b.tZ)(te.Z,{to:(0,ae.e1)({orgSlug:e.slug,transaction:s.transaction,projectID:null==a?void 0:a.id,query:{query:"transaction.duration:<15m"}}),children:s.transaction})}),(0,b.tZ)(me,{children:a&&(0,b.tZ)(pe,{avatarSize:18,project:a})}),(0,b.tZ)("div",{children:g}),(0,b.tZ)("div",{children:null!=Z?Z:"—"}),(0,b.tZ)(Ze,{children:0===v?(0,b.BX)(ve,{children:["0% ",(0,h.t)("change")]}):(0,b.BX)(xe,{color:d>=0?"green300":"red300",children:["".concat(v,"% "),d>=0?(0,h.t)("better"):(0,h.t)("worse")]})})]},i)}))}),p.length>=8&&!l&&!i&&(0,b.BX)(fe,{onClick:function(){c(!0)},children:[(0,b.BX)(be,{children:[(0,b.tZ)(ye,{color:"gray300"}),(0,h._N)("Show [count] More",{count:p.length-1-8})]}),(0,b.tZ)(re.g6,{color:"gray300",direction:"down"})]})]})}function le({organization:e,projects:t,location:r,period:s,start:n,end:o}){if(0===t.length)return(0,b.tZ)(de,{isLoading:!1,organization:e,location:r,projects:[],period:s,periodTableData:{data:[]},weekTableData:{data:[]}});const i={id:void 0,query:"transaction.duration:<15m team_key_transaction:true",projects:t.map((e=>Number(e.id))),version:2,orderby:"-tpm",fields:["transaction","project","tpm()","count_unique(user)","count_miserable(user)","user_misery()"]},a=oe.ZP.fromSavedQuery({...i,name:"periodMisery",range:s,start:n,end:o}),d=oe.ZP.fromSavedQuery({...i,name:"weekMisery",range:"7d"});return(0,b.tZ)(ne.Z,{eventView:a,orgSlug:e.slug,location:r,children:({isLoading:n,tableData:o})=>(0,b.tZ)(ne.Z,{eventView:d,orgSlug:e.slug,location:r,children:({isLoading:i,tableData:a})=>(0,b.tZ)(de,{isLoading:n||i,organization:e,location:r,projects:t,period:s,periodTableData:o,weekTableData:a})})})}de.displayName="TeamMisery",le.displayName="TeamMiseryWrapper";const ce=le,ue=(0,s.Z)(O.Z,{target:"eolow3y10"})("grid-template-columns:1fr 0.5fr 112px 112px 0.25fr;font-size:",(e=>e.theme.fontSizeMedium),";white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,Z.Z)(1)," ",(0,Z.Z)(2),";}",(e=>e.isEmpty&&(0,ee.iv)("&>div:last-child{padding:48px ",(0,Z.Z)(2),";}","")),";"),me=(0,s.Z)("div",{target:"eolow3y9"})({name:"zjik7",styles:"display:flex"}),pe=(0,s.Z)(F.Z,{target:"eolow3y8"})({name:"ozd7xs",styles:"flex-shrink:0"}),ge=(0,s.Z)("div",{target:"eolow3y7"})(se.Z,";"),he=(0,s.Z)("span",{target:"eolow3y6"})({name:"2qga7i",styles:"text-align:right"}),Ze=(0,s.Z)("div",{target:"eolow3y5"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),ve=(0,s.Z)("div",{target:"eolow3y4"})("color:",(e=>e.theme.subText),";"),xe=(0,s.Z)("div",{target:"eolow3y3"})("color:",(e=>e.theme[e.color]),";"),fe=(0,s.Z)("div",{target:"eolow3y2"})("display:flex;align-items:center;padding:",(0,Z.Z)(1)," ",(0,Z.Z)(2),";color:",(e=>e.theme.subText),";cursor:pointer;border-top:1px solid ",(e=>e.theme.border),";"),ye=(0,s.Z)(re.Zd,{target:"eolow3y1"})("margin-right:",(0,Z.Z)(1),";"),be=(0,s.Z)("div",{target:"eolow3y0"})({name:"18keaja",styles:"display:flex;align-items:center;flex-grow:1"});var we=r("../node_modules/lodash/round.js"),je=r.n(we);class Se extends D.Z{constructor(...e){super(...e),(0,R.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekReleases:null,periodReleases:null}}getEndpoints(){const{organization:e,start:t,end:r,period:s,utc:n,teamSlug:o}=this.props,i={start:t,end:r,period:s,utc:n};return[["periodReleases","/teams/".concat(e.slug,"/").concat(o,"/release-count/"),{query:{...(0,p.Q)(i)}}],["weekReleases","/teams/".concat(e.slug,"/").concat(o,"/release-count/"),{query:{statsPeriod:"7d"}}]]}componentDidUpdate(e){const{teamSlug:t,start:r,end:s,period:n,utc:o}=this.props;e.start===r&&e.end===s&&e.period===n&&e.utc===o&&A()(e.teamSlug,t)||this.remountComponent()}getReleaseCount(e,t){const{periodReleases:r,weekReleases:s}=this.state,n="week"===t?null==s?void 0:s.last_week_totals:null==r?void 0:r.project_avgs;return null!=n&&n[e]?Math.ceil(null==n?void 0:n[e]):0}getTrend(e){const t=this.getReleaseCount(e,"period"),r=this.getReleaseCount(e,"week");return null===t||null===r?null:r-t}renderLoading(){return this.renderBody()}renderReleaseCount(e,t){const{loading:r}=this.state;if(r)return(0,b.tZ)("div",{children:(0,b.tZ)(U.Z,{width:"80px",height:"25px"})});const s=this.getReleaseCount(Number(e),t);return null===s?"—":s}renderTrend(e){const{loading:t}=this.state;if(t)return(0,b.tZ)("div",{children:(0,b.tZ)(U.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"—":(0,b.BX)(Ne,{color:r>=0?"green300":"red300",children:["".concat(je()(Math.abs(r),3)),(0,b.tZ)(De,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){var e,t;const{projects:r,period:s}=this.props,{periodReleases:o}=this.state,i=Object.entries(null!==(e=null==o?void 0:o.release_counts)&&void 0!==e?e:{}).map((([e,t])=>({value:Math.ceil(t),name:new Date(e).getTime()}))).sort(((e,t)=>e.name-t.name)),a=Object.values(null!==(t=null==o?void 0:o.project_avgs)&&void 0!==t?t:{}).reduce(((e,t)=>e+t),0),d=M()(i,7).map((e=>({name:e[0].name,value:e.reduce(((e,t)=>e+t.value),0)}))),l=M()(i,7).map((e=>({name:e[0].name,value:Math.ceil(a/r.length)})));return(0,b.BX)("div",{children:[(0,b.tZ)(ke,{children:(0,b.tZ)(ze,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",legend:{right:3,top:0},yAxis:{minInterval:1},xAxis:{type:"time"},series:[{seriesName:(0,h.t)("This Period"),data:d}],previousPeriod:[{seriesName:(0,h.t)("Last ".concat(s," Average")),data:null!=l?l:[]}]})}),(0,b.tZ)(_e,{isEmpty:0===r.length,headers:[(0,h.t)("Project"),(0,b.tZ)(Be,{children:(0,h._N)("Last [period] Average",{period:s})},"last"),(0,b.tZ)(Be,{children:(0,h.t)("This Week")},"curr"),(0,b.tZ)(Be,{children:(0,h.t)("Difference")},"diff")],children:r.map((e=>(0,b.BX)(n.Fragment,{children:[(0,b.tZ)(Ce,{children:(0,b.tZ)(Me,{avatarSize:18,project:e})}),(0,b.tZ)(Re,{children:this.renderReleaseCount(e.id,"period")}),(0,b.tZ)(Re,{children:this.renderReleaseCount(e.id,"week")}),(0,b.tZ)(Re,{children:this.renderTrend(e.id)})]},e.id)))})]})}}const Te=Se,ke=(0,s.Z)("div",{target:"e1amjc2g8"})("padding:",(0,Z.Z)(2),";border-bottom:1px solid ",(e=>e.theme.border),";"),ze=(0,s.Z)(N.Z,{target:"e1amjc2g7"})(""),_e=(0,s.Z)(O.Z,{target:"e1amjc2g6"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;white-space:nowrap;margin-bottom:0;border:0;font-size:",(e=>e.theme.fontSizeMedium),";box-shadow:unset;&>div{padding:",(0,Z.Z)(1)," ",(0,Z.Z)(2),";}"),Be=(0,s.Z)("span",{target:"e1amjc2g5"})({name:"2qga7i",styles:"text-align:right"}),Re=(0,s.Z)("div",{target:"e1amjc2g4"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),De=(0,s.Z)(re.CC,{target:"e1amjc2g3"})("margin:0 ",(0,Z.Z)(.5),";"),Ne=(0,s.Z)("div",{target:"e1amjc2g2"})("color:",(e=>e.theme[e.color]),";"),Ce=(0,s.Z)("div",{target:"e1amjc2g1"})({name:"zjik7",styles:"display:flex"}),Me=(0,s.Z)(F.Z,{target:"e1amjc2g0"})({name:"ozd7xs",styles:"flex-shrink:0"});class Pe extends D.Z{constructor(...e){super(...e),(0,R.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),resolutionTime:null}}getEndpoints(){const{organization:e,start:t,end:r,period:s,utc:n,teamSlug:o}=this.props,i={start:t,end:r,period:s,utc:n};return[["resolutionTime","/teams/".concat(e.slug,"/").concat(o,"/time-to-resolution/"),{query:{...(0,p.Q)(i)}}]]}renderLoading(){return(0,b.tZ)(qe,{children:(0,b.tZ)(m.Z,{})})}renderBody(){const{resolutionTime:e}=this.state,t=P(Object.entries(null!=e?e:{}).map((([e,{avg:t}])=>({value:t,name:new Date(e).getTime()}))));return(0,b.tZ)(qe,{children:(0,b.tZ)(N.Z,{style:{height:190},isGroupedByDate:!0,useShortDate:!0,period:"7d",tooltip:{valueFormatter:e=>(0,Q.g9)(e,1)},yAxis:{minInterval:86400,axisLabel:{formatter:e=>0===e?"":(0,Q.g9)(e,0,!0,!0)}},legend:{right:0,top:0},xAxis:{type:"time"},series:[{seriesName:(0,h.t)("Time to Resolution"),data:t}].reverse()})})}}const Le=Pe,qe=(0,s.Z)("div",{target:"ev7cfap0"})("padding:",(0,Z.Z)(2)," ",(0,Z.Z)(2)," 0 ",(0,Z.Z)(2),";");var Ie=r("./app/types/index.tsx"),Xe=r("./app/utils/sessions.tsx"),Ee=r("./app/views/releases/utils/index.tsx");class Ae extends D.Z{constructor(...e){super(...e),(0,R.Z)(this,"shouldRenderBadRequests",!0)}getDefaultState(){return{...super.getDefaultState(),weekSessions:null,periodSessions:null}}getEndpoints(){const{organization:e,start:t,end:r,period:s,utc:n,projects:o}=this.props,i=o.filter((e=>e.hasSessions));if(0===i.length)return[];const a={start:t,end:r,period:s,utc:n},d={environment:[],project:i.map((e=>e.id)),field:"sum(session)",groupBy:["session.status","project"],interval:"1d"};return[["periodSessions","/organizations/".concat(e.slug,"/sessions/"),{query:{...d,...(0,p.Q)(a)}}],["weekSessions","/organizations/".concat(e.slug,"/sessions/"),{query:{...d,statsPeriod:"7d"}}]]}componentDidUpdate(e){const{projects:t,start:r,end:s,period:n,utc:o}=this.props;e.start===r&&e.end===s&&e.period===n&&e.utc===o&&A()(e.projects,t)||this.remountComponent()}getScore(e,t){const{periodSessions:r,weekSessions:s}=this.state,n="week"===t?s:r,o=null==n?void 0:n.groups.filter((t=>t.by.project===e));return(0,Xe.Pn)(o,Ie.r2.SESSIONS)}getTrend(e){const t=this.getScore(e,"period"),r=this.getScore(e,"week");return null===t||null===r?null:r-t}renderLoading(){return this.renderBody()}renderScore(e,t){const{loading:r}=this.state;if(r)return(0,b.tZ)("div",{children:(0,b.tZ)(U.Z,{width:"80px",height:"25px"})});const s=this.getScore(Number(e),t);return null===s?"—":(0,Ee.zB)(s)}renderTrend(e){const{loading:t}=this.state;if(t)return(0,b.tZ)("div",{children:(0,b.tZ)(U.Z,{width:"80px",height:"25px"})});const r=this.getTrend(Number(e));return null===r?"—":(0,b.BX)(Ge,{color:r>=0?"green300":"red300",children:["".concat(je()(Math.abs(r),3),"%"),(0,b.tZ)(We,{direction:r>=0?"up":"down",size:"xs"})]})}renderBody(){const{projects:e,period:t}=this.props;return(0,b.tZ)(Oe,{isEmpty:0===e.length,headers:[(0,h.t)("Project"),(0,b.tZ)(Ue,{children:(0,h._N)("Last [period]",{period:t})},"last"),(0,b.tZ)(Ue,{children:(0,h.t)("This Week")},"curr"),(0,b.tZ)(Ue,{children:(0,h.t)("Difference")},"diff")],children:e.map((e=>(0,b.BX)(n.Fragment,{children:[(0,b.tZ)(Ve,{children:(0,b.tZ)(He,{avatarSize:18,project:e})}),(0,b.tZ)(Qe,{children:this.renderScore(e.id,"period")}),(0,b.tZ)(Qe,{children:this.renderScore(e.id,"week")}),(0,b.tZ)(Qe,{children:this.renderTrend(e.id)})]},e.id)))})}}const Fe=Ae,Oe=(0,s.Z)(O.Z,{target:"e1li5m366"})("grid-template-columns:1fr 0.2fr 0.2fr 0.2fr;white-space:nowrap;margin-bottom:0;border:0;box-shadow:unset;&>div{padding:",(0,Z.Z)(1)," ",(0,Z.Z)(2),";}"),Ue=(0,s.Z)("span",{target:"e1li5m365"})({name:"2qga7i",styles:"text-align:right"}),Qe=(0,s.Z)("div",{target:"e1li5m364"})({name:"4os8x4",styles:"display:flex;align-items:center;justify-content:flex-end;text-align:right"}),We=(0,s.Z)(re.CC,{target:"e1li5m363"})("margin:0 ",(0,Z.Z)(.5),";"),Ge=(0,s.Z)("div",{target:"e1li5m362"})("color:",(e=>e.theme[e.color]),";"),Ve=(0,s.Z)("div",{target:"e1li5m361"})({name:"zjik7",styles:"display:flex"}),He=(0,s.Z)(F.Z,{target:"e1li5m360"})({name:"ozd7xs",styles:"flex-shrink:0"}),Je="8w",Ke=["pageStatsPeriod","pageStart","pageEnd","pageUtc","dataCategory","transform","sort","query","cursor","team"];function Ye({organization:e,teams:t,loadingTeams:r,location:s,router:i}){var d,c,g,x,f;const y=(0,o.u)(),w=null!==(d=null==s?void 0:s.query)&&void 0!==d?d:{},S="teamInsightsSelectedTeamId:".concat(e.slug);let T=null!==(c=w.team)&&void 0!==c?c:v.Z.getItem(S);T&&!t.find((e=>e.id===T))&&(T=null);const k=null!==(g=T)&&void 0!==g?g:null===(x=t[0])||void 0===x?void 0:x.id,z=t.find((e=>e.id===k)),_=null!==(f=null==z?void 0:z.projects)&&void 0!==f?f:[];function R(e){const t=a()(e,Ke),r={...s,query:{...w,...t}};return i.push(r),r}const{period:D,start:N,end:C,utc:M}=function(){const{start:e,end:t,statsPeriod:r,utc:s}=(0,p.Q)(w,{allowEmptyPeriod:!0,allowAbsoluteDatetime:!0,allowAbsolutePageDatetime:!0});if(!r&&!e&&!t)return{period:Je};if(r)return{period:r};const n="true"===s;return e&&t?n?{start:l().utc(e).format(),end:l().utc(t).format(),utc:n}:{start:l()(e).utc().format(),end:l()(t).utc().format(),utc:n}:{period:Je}}();return(0,b.BX)(n.Fragment,{children:[(0,b.tZ)(tt,{children:(0,b.tZ)(rt,{children:(0,b.tZ)(st,{children:(0,h.t)("Projects")})})}),(0,b.tZ)(u.h4,{children:(0,b.tZ)(B.Z,{organization:e,activeTab:"teamInsights"})}),(0,b.BX)(et,{children:[r&&(0,b.tZ)(m.Z,{}),!r&&(0,b.BX)(u.or,{fullWidth:!0,children:[(0,b.BX)(nt,{children:[(0,b.tZ)(ot,{name:"select-team",inFieldLabel:(0,h.t)("Team: "),value:null==z?void 0:z.slug,isLoading:r,onChange:e=>{return t=e.actor.id,v.Z.setItem(S,t),void R({team:t});var t},teamFilter:e=>e.isMember,styles:{singleValue(e){const t={display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:y.fontSizeMedium,":before":{...e[":before"],color:y.textColor,marginRight:(0,Z.Z)(1.5),marginLeft:(0,Z.Z)(.5)}};return{...e,...t}},input:(e,t)=>({...e,display:"grid",gridTemplateColumns:"max-content 1fr",alignItems:"center",gridGap:(0,Z.Z)(1),":before":{backgroundColor:t.theme.backgroundSecondary,height:24,width:38,borderRadius:3,content:'""',display:"block"}})}}),(0,b.tZ)(it,{organization:e,relative:null!=D?D:"",start:null!=N?N:null,end:null!=C?C:null,utc:null!=M?M:null,onUpdate:function(e){const{start:t,end:r,relative:s,utc:n}=e;if(t&&r){const e=n?l().utc:l();return R({pageStatsPeriod:void 0,pageStart:e(t).format(),pageEnd:e(r).format(),pageUtc:null!=n?n:void 0})}return R({pageStatsPeriod:s||void 0,pageStart:void 0,pageEnd:void 0,pageUtc:void 0})},showAbsolute:!1,relativeOptions:{"14d":(0,h.t)("Last 2 weeks"),"4w":(0,h.t)("Last 4 weeks"),[Je]:(0,h.t)("Last 8 weeks"),"12w":(0,h.t)("Last 12 weeks")}})]}),(0,b.tZ)(at,{children:(0,h.t)("Project Health")}),(0,b.tZ)(j,{title:(0,h.t)("Crash Free Sessions"),description:(0,h.t)("The percentage of healthy, errored, and abnormal sessions that did not cause a crash."),children:(0,b.tZ)(Fe,{projects:_,organization:e,period:D,start:N,end:C,utc:M})}),(0,b.tZ)(j,{title:(0,h.t)("User Misery"),description:(0,h.t)("User Misery shows the number of unique users that experienced load times 4x the project’s configured threshold."),children:(0,b.tZ)(ce,{organization:e,projects:_,period:D,start:null==N?void 0:N.toString(),end:null==C?void 0:C.toString(),location:s})}),(0,b.tZ)(j,{title:(0,h.t)("Metric Alerts Triggered"),description:(0,h.t)("These are the alerts triggered from the Alert Rules your team created."),children:(0,b.tZ)(I,{organization:e,teamSlug:z.slug,period:D,start:null==N?void 0:N.toString(),end:null==C?void 0:C.toString(),location:s})}),(0,b.tZ)(at,{children:(0,h.t)("Team Activity")}),(0,b.tZ)(j,{title:(0,h.t)("Issues Reviewed"),description:(0,h.t)("Issues that were triaged by your team taking an action on them such as resolving, ignoring, marking as reviewed, or deleting."),children:(0,b.tZ)(G,{organization:e,projects:_,teamSlug:z.slug,period:D,start:null==N?void 0:N.toString(),end:null==C?void 0:C.toString(),location:s})}),(0,b.tZ)(j,{title:(0,h.t)("Time to Resolution"),description:(0,h.t)("This shows the mean time it took for issues to be resolved by your team.\n                 If issues took a long time to resolve, this could be a problem that your team needs to fix."),children:(0,b.tZ)(Le,{organization:e,teamSlug:z.slug,period:D,start:null==N?void 0:N.toString(),end:null==C?void 0:C.toString(),location:s})}),(0,b.tZ)(j,{title:(0,h.t)("Number of Releases"),description:(0,h.t)("Projects that had the largest difference of releases deployed compared to the 12 week average."),children:(0,b.tZ)(Te,{projects:_,organization:e,teamSlug:z.slug,period:D,start:N,end:C,utc:M})})]})]})]})}Ye.displayName="TeamInsightsOverview";const $e=(0,x.Z)((0,f.Z)((0,y.Z)(Ye))),et=(0,s.Z)(u.uT,{target:"e1sxv5jt7"})("margin-bottom:-20px;@media (min-width: ",(e=>e.theme.breakpoints[1]),"){display:block;}"),tt=(0,s.Z)(u.h4,{target:"e1sxv5jt6"})({name:"w8lbxe",styles:"border-bottom:0"}),rt=(0,s.Z)(u.oB,{target:"e1sxv5jt5"})({name:"1ykowef",styles:"margin-bottom:0"}),st=(0,s.Z)(u.Dx,{target:"e1sxv5jt4"})("margin-top:",(0,Z.Z)(.5),";"),nt=(0,s.Z)("div",{target:"e1sxv5jt3"})("display:grid;align-items:center;gap:",(0,Z.Z)(1),";margin-bottom:",(0,Z.Z)(2),";@media (min-width: ",(e=>e.theme.breakpoints[0]),"){grid-template-columns:246px 1fr;}"),ot=(0,s.Z)(c.Z,{target:"e1sxv5jt2"})("&>div{box-shadow:",(e=>e.theme.dropShadowLight),";}"),it=(0,s.Z)(g.Z,{target:"e1sxv5jt1"})({name:"j6w5js",styles:"height:40px;div{min-height:unset;}"}),at=(0,s.Z)(u.Dx,{target:"e1sxv5jt0"})("margin-bottom:",(0,Z.Z)(1),"!important;")},"../node_modules/lodash/_baseMean.js":(e,t,r)=>{var s=r("../node_modules/lodash/_baseSum.js");e.exports=function(e,t){var r=null==e?0:e.length;return r?s(e,t)/r:NaN}},"../node_modules/lodash/_baseSum.js":e=>{e.exports=function(e,t){for(var r,s=-1,n=e.length;++s<n;){var o=t(e[s]);void 0!==o&&(r=void 0===r?o:r+o)}return r}},"../node_modules/lodash/mean.js":(e,t,r)=>{var s=r("../node_modules/lodash/_baseMean.js"),n=r("../node_modules/lodash/identity.js");e.exports=function(e){return s(e,n)}}}]);
//# sourceMappingURL=../sourcemaps/app_views_teamInsights_overview_tsx-node_modules_lodash_mean_js.3261e2841d52a7cb96a7bff160ffc118.js.map