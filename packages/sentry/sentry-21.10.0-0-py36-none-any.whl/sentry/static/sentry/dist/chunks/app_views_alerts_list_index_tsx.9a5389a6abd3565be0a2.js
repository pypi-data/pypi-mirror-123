"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["app_views_alerts_list_index_tsx"],{"./app/components/onboardingPanel.tsx":(t,e,s)=>{s.d(e,{Z:()=>m});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/react/index.js"),s("./app/components/panels/index.tsx")),r=s("./app/styles/space.tsx"),a=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o({className:t,image:e,children:s}){return(0,a.tZ)(n.s_,{className:t,children:(0,a.BX)(l,{children:[(0,a.tZ)(p,{children:e}),(0,a.tZ)(d,{children:s})]})})}o.displayName="OnboardingPanel";const l=(0,i.Z)("div",{target:"e19tujos2"})("padding:",(0,r.Z)(3),";position:relative;@media (min-width: ",(t=>t.theme.breakpoints[0]),"){display:flex;align-items:center;flex-direction:row;justify-content:center;flex-wrap:wrap;min-height:300px;max-width:1000px;margin:0 auto;}@media (min-width: ",(t=>t.theme.breakpoints[1]),"){min-height:350px;}"),d=(0,i.Z)("div",{target:"e19tujos1"})("z-index:1;@media (min-width: ",(t=>t.theme.breakpoints[0]),"){flex:2;}"),p=(0,i.Z)(d,{target:"e19tujos0"})("position:relative;min-height:100px;max-width:300px;margin:",(0,r.Z)(2)," auto;@media (min-width: ",(t=>t.theme.breakpoints[0]),"){flex:1;margin:",(0,r.Z)(3),";max-width:auto;}"),m=o},"./app/views/alerts/list/index.tsx":(t,e,s)=>{s.r(e),s.d(e,{default:()=>U});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),r=(s("../node_modules/core-js/modules/web.dom-collections.iterator.js"),s("../node_modules/react/index.js")),a=s("../node_modules/lodash/flatten.js"),o=s.n(a),l=s("./app/actionCreators/prompts.tsx"),d=s("./app/components/acl/feature.tsx"),p=s("./app/components/alert.tsx"),m=s("./app/components/asyncComponent.tsx"),c=s("./app/components/button.tsx"),h=s("./app/components/createAlertButton.tsx"),u=s("./app/components/layouts/thirds.tsx"),g=s("./app/components/links/externalLink.tsx"),x=s("./app/components/organizations/globalSelectionHeader/index.tsx"),y=s("./app/components/pagination.tsx"),Z=s("./app/components/panels/index.tsx"),w=s("./app/components/searchBar.tsx"),f=s("./app/components/sentryDocumentTitle.tsx"),b=s("./app/icons/index.tsx"),v=s("./app/locale.tsx"),z=s("./app/styles/space.tsx"),S=s("./app/utils/analytics.tsx"),j=s("./app/utils/projects.tsx"),_=s("./app/utils/withOrganization.tsx"),k=s("./app/utils/withTeams.tsx"),L=s("./app/views/alerts/rules/teamFilter.tsx"),A=s("./app/views/alerts/list/header.tsx"),q=s("./images/spot/alerts-empty-state.svg"),B=s("./app/components/buttonBar.tsx"),C=s("./app/components/onboardingPanel.tsx"),N=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function X({actions:t}){return(0,N.BX)(C.Z,{image:(0,N.tZ)(T,{src:q}),children:[(0,N.tZ)("h3",{children:(0,v.t)("More signal, less noise")}),(0,N.tZ)("p",{children:(0,v.t)("Not every error is worth an email. Set your own rules for alerts you need, with information that helps.")}),(0,N.tZ)(F,{gap:1,children:t})]})}X.displayName="Onboarding";const T=(0,n.Z)("img",{target:"evp2sp81"})("@media (min-width: ",(t=>t.theme.breakpoints[0]),"){user-select:none;position:absolute;top:0;bottom:0;width:220px;margin-top:auto;margin-bottom:auto;transform:translateX(-50%);left:50%;}@media (min-width: ",(t=>t.theme.breakpoints[2]),"){transform:translateX(-60%);width:280px;}@media (min-width: ",(t=>t.theme.breakpoints[3]),"){transform:translateX(-75%);width:320px;}"),F=(0,n.Z)(B.ZP,{target:"evp2sp80"})({name:"vpj881",styles:"grid-template-columns:repeat(auto-fit, minmax(130px, max-content))"}),I=X;var P=s("./app/views/alerts/list/row.tsx");const R="https://docs.sentry.io/workflow/alerts-notifications/alerts/?_ga=2.21848383.580096147.1592364314-1444595810.1582160976";class V extends m.Z{constructor(...t){super(...t),(0,i.Z)(this,"handleChangeSearch",(t=>{const{router:e,location:s}=this.props,{cursor:i,page:n,...r}=s.query;e.push({pathname:s.pathname,query:{...r,title:t}})})),(0,i.Z)(this,"handleChangeFilter",((t,e)=>{const{router:s,location:i}=this.props,{cursor:n,page:r,...a}=i.query;let o=a.team;"teams"===t&&(o=e.size?[...e]:"");let l=a.status;"status"===t&&(l=e.size?[...e]:""),s.push({pathname:i.pathname,query:{...a,status:l,team:0===o.length?"":o}})}))}getEndpoints(){const{params:t,location:e}=this.props,{query:s}=e,i=this.getQueryStatus(s.status);return 1===i.length&&(s.status=i),s.team=(0,L.L)(s.team),s.expand=["original_alert_rule"],[["incidentList","/organizations/".concat(null==t?void 0:t.orgId,"/incidents/"),{query:s}]]}getQueryStatus(t){return Array.isArray(t)?t:""===t?[]:["open","closed"].includes(t)?[t]:[]}async onLoadAllEndpointsSuccess(){const{incidentList:t}=this.state;if(!t||0!==t.length)return void this.setState({hasAlertRule:!0,firstVisitShown:!1});this.setState({loading:!0});const{params:e,location:s,organization:i}=this.props,n=(await this.api.requestPromise("/organizations/".concat(null==e?void 0:e.orgId,"/alert-rules/"),{method:"GET",query:s.query})).length>0;if(n)return void this.setState({hasAlertRule:n,firstVisitShown:!1,loading:!1});const r=await(0,l.vu)(this.api,{organizationId:i.id,feature:"alert_stream"}),a=!(null!=r&&r.dismissedTime);a&&(0,l.Xt)(this.api,{feature:"alert_stream",organizationId:i.id,status:"dismissed"}),this.setState({hasAlertRule:n,firstVisitShown:a,loading:!1})}renderFilterBar(){var t;const{teams:e,location:s}=this.props,i=new Set((0,L.L)(s.query.team)),n=new Set(this.getQueryStatus(s.query.status));return(0,N.BX)(E,{children:[(0,N.tZ)(L.Z,{showStatus:!0,teams:e,selectedStatus:n,selectedTeams:i,handleChangeFilter:this.handleChangeFilter}),(0,N.tZ)(M,{placeholder:(0,v.t)("Search by name"),query:null===(t=s.query)||void 0===t?void 0:t.name,onSearch:this.handleChangeSearch})]})}tryRenderOnboarding(){const{firstVisitShown:t}=this.state,{organization:e}=this.props;if(!t)return null;const s=(0,N.BX)(r.Fragment,{children:[(0,N.tZ)(c.ZP,{size:"small",external:!0,href:R,children:(0,v.t)("View Features")}),(0,N.tZ)(h.Z,{organization:e,iconProps:{size:"xs"},size:"small",priority:"primary",referrer:"alert_stream",children:(0,v.t)("Create Alert Rule")})]});return(0,N.tZ)(I,{actions:s})}renderLoading(){return this.renderBody()}renderList(){var t;const{loading:e,incidentList:s,incidentListPageLinks:i,hasAlertRule:n}=this.state,{params:{orgId:a},organization:l}=this.props,d=new Set(o()(null==s?void 0:s.map((({projects:t})=>t)))),p=!(!s||0!==s.length||void 0!==n),m=e||p;return(0,N.BX)(r.Fragment,{children:[null!==(t=this.tryRenderOnboarding())&&void 0!==t?t:(0,N.tZ)(Z.KB,{isLoading:m,isEmpty:0===(null==s?void 0:s.length),emptyMessage:(0,v.t)("No incidents exist for the current query."),emptyAction:(0,N.tZ)(K,{children:(0,v._N)("Learn more about [link:Metric Alerts]",{link:(0,N.tZ)(g.Z,{href:R})})}),headers:[(0,v.t)("Alert Rule"),(0,v.t)("Triggered"),(0,v.t)("Duration"),(0,v.t)("Project"),(0,v.t)("Alert ID"),(0,v.t)("Team")],children:(0,N.tZ)(j.Z,{orgId:a,slugs:Array.from(d),children:({initiallyLoaded:t,projects:e})=>s.map((s=>(0,N.tZ)(P.Z,{projectsLoaded:t,projects:e,incident:s,orgId:a,organization:l},s.id)))})}),(0,N.tZ)(y.Z,{pageLinks:i})]})}renderBody(){const{params:t,organization:e,router:s}=this.props,{orgId:i}=t;return(0,N.tZ)(f.Z,{title:(0,v.t)("Alerts"),orgSlug:i,children:(0,N.BX)(x.Z,{organization:e,showDateSelector:!1,children:[(0,N.tZ)(A.Z,{organization:e,router:s,activeTab:"stream"}),(0,N.tZ)(Q,{children:(0,N.BX)(u.or,{fullWidth:!0,children:[!this.tryRenderOnboarding()&&(0,N.BX)(r.Fragment,{children:[(0,N.tZ)(O,{icon:(0,N.tZ)(b.aU,{}),children:(0,v.t)("This page only shows metric alerts.")}),this.renderFilterBar()]}),this.renderList()]})})]})})}}class D extends r.Component{componentDidMount(){this.trackView()}componentDidUpdate(t){var e,s;(null===(e=t.location.query)||void 0===e?void 0:e.status)!==(null===(s=this.props.location.query)||void 0===s?void 0:s.status)&&this.trackView()}trackView(){const{organization:t}=this.props;(0,S.ec)({eventKey:"alert_stream.viewed",eventName:"Alert Stream: Viewed",organization_id:t.id})}renderNoAccess(){return(0,N.tZ)(u.uT,{children:(0,N.tZ)(u.or,{fullWidth:!0,children:(0,N.tZ)(p.Z,{type:"warning",children:(0,v.t)("You don't have access to this feature")})})})}render(){const{organization:t}=this.props;return(0,N.tZ)(d.Z,{features:["organizations:incidents"],organization:t,hookName:"feature-disabled:alerts-page",renderDisabled:this.renderNoAccess,children:(0,N.tZ)(V,{...this.props})})}}D.displayName="IncidentsListContainer";const O=(0,n.Z)(p.Z,{target:"e12ryirh4"})("margin-bottom:",(0,z.Z)(1.5),";"),E=(0,n.Z)("div",{target:"e12ryirh3"})("display:flex;margin-bottom:",(0,z.Z)(1.5),";"),M=(0,n.Z)(w.Z,{target:"e12ryirh2"})("flex-grow:1;margin-left:",(0,z.Z)(1.5),";"),Q=(0,n.Z)(u.uT,{target:"e12ryirh1"})({name:"108qp7n",styles:"margin-bottom:-20px"}),K=(0,n.Z)("p",{target:"e12ryirh0"})("font-size:",(t=>t.theme.fontSizeLarge),";"),U=(0,_.Z)((0,k.Z)(D))},"./images/spot/alerts-empty-state.svg":(t,e,s)=>{t.exports=s.p+"assets/alerts-empty-state.4d03bc7c2675b8facd23.svg"}}]);
//# sourceMappingURL=../sourcemaps/app_views_alerts_list_index_tsx.32bcf319d0166f91c370618f96cbfc78.js.map